{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js!/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/page/shopCart.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/page/shopCart.vue","mtime":1741743644074},{"path":"/Users/macos/Desktop/-Second-hand-mall/babel.config.js","mtime":1741743639580},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js","mtime":1741743640250},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport AppHead from '@/components/common/AppHeader.vue';\nimport AppBody from '@/components/common/AppPageBody.vue';\nimport AppFoot from '@/components/common/AppFoot.vue';\nexport default {\n  name: \"shopCart\",\n  components: {\n    AppHead: AppHead,\n    AppBody: AppBody,\n    AppFoot: AppFoot\n  },\n  data: function data() {\n    return {\n      isShowTip: false,\n      tipContent: \"\",\n      dataList: [],\n      idlePlace: '',\n      total: 0,\n      idleItemids: [],\n      favoriteIds: []\n    };\n  },\n  mounted: function mounted() {},\n  created: function created() {\n    var _this = this;\n    if (!this.$globalData.userInfo.nickname) {\n      this.$api.getUserInfo().then(function (res) {\n        if (res.status_code === 1) {\n          res.data.signInTime = res.data.signInTime.substring(0, 10);\n          console.log(res.data);\n          _this.$globalData.userInfo = res.data;\n          _this.userInfo = _this.$globalData.userInfo;\n        }\n      });\n    } else {\n      this.userInfo = this.$globalData.userInfo;\n      console.log(this.userInfo);\n    }\n    this.getMyFavorite();\n    this.getIdleItemData();\n  },\n  computed: {},\n  methods: {\n    /*支付功能*/payAll: function payAll() {\n      var _this2 = this;\n      this.$api.addOrderByIds({\n        idleItemIds: this.idleItemids,\n        total_price: this.total\n      }).then(function (res) {\n        console.log(res);\n        if (res.status_code === 1) {\n          _this2.$api.removeShopCartByIds({\n            favoriteIds: _this2.favoriteIds\n          }).then(function (res) {\n            // alert(\"支付成功，商品已经从购物车中移出\")\n          });\n          _this2.$router.push({\n            path: '/order',\n            query: {\n              id: res.data.id\n            }\n          });\n        } else {\n          _this2.$message.error(res.msg);\n        }\n      }).catch(function (e) {});\n    },\n    /*多选框*/toggleSelection: function toggleSelection(rows) {\n      var _this3 = this;\n      if (rows) {\n        rows.forEach(function (row) {\n          _this3.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n    handleSelectionChange: function handleSelectionChange(val) {\n      this.multipleSelection = val;\n      console.log(val);\n\n      /*计算勾选总价*/\n      if (val.length !== 0) {\n        for (var i = 0; i < val.length; i++) {\n          this.idleItemids[i] = val[i].id;\n          this.favoriteIds[i] = val[i].favoriteId;\n        }\n        console.log(this.idleItemids, this.favoriteIds);\n        this.total = this.countTotal(val, 'idlePrice');\n      } else {\n        this.total = 0;\n      }\n    },\n    countTotal: function countTotal(arr, keyName) {\n      var $total = 0;\n      $total = arr.reduce(function (total, currentValue, currentIndex, arr) {\n        return currentValue[keyName] ? total + currentValue[keyName] : total;\n      }, 0);\n      return $total;\n    },\n    removeShopCart: function removeShopCart(row, index) {\n      var _this4 = this;\n      this.$api.deleteFavorite({\n        id: row.favoriteId\n      }).then(function (res) {\n        console.log(res);\n        console.log(row);\n        // console.log(\"列表的数据\"+ row.id);\n        if (res.status_code === 1) {\n          _this4.$message({\n            message: '已取消购物车！',\n            type: 'success'\n          });\n          _this4.dataList.splice(index, 1);\n          // this.getMyFavorite()\n        } else {\n          _this4.$message.error(res.msg);\n        }\n        // this.getMyFavorite()\n      });\n    },\n    /*获取购物车内容*/getMyFavorite: function getMyFavorite() {\n      var _this5 = this;\n      this.$api.getMyFavorite().then(function (res) {\n        console.log('getMyFavorite', res);\n        if (res.status_code === 1) {\n          for (var i = 0; i < res.data.length; i++) {\n            var pictureList = JSON.parse(res.data[i].idleItem.pictureList);\n            _this5.dataList.push({\n              favoriteId: res.data[i].id,\n              id: res.data[i].idleItem.id,\n              imgUrl: pictureList.length > 0 ? pictureList[0] : '',\n              idleName: res.data[i].idleItem.idleName,\n              idleDetails: res.data[i].idleItem.idleDetails,\n              timeStr: res.data[i].createTime.substring(0, 10) + \" \" + res.data[i].createTime.substring(11, 19),\n              idlePrice: res.data[i].idleItem.idlePrice,\n              idleStatus: res.data[i].idleItem.idleStatus\n            });\n            _this5.idlePlace = res.data[i].idleItem.idlePlace;\n          }\n        }\n      });\n    }\n  }\n};",{"version":3,"names":["AppHead","AppBody","AppFoot","name","components","data","isShowTip","tipContent","dataList","idlePlace","total","idleItemids","favoriteIds","mounted","created","_this","$globalData","userInfo","nickname","$api","getUserInfo","then","res","status_code","signInTime","substring","console","log","getMyFavorite","getIdleItemData","computed","methods","payAll","_this2","addOrderByIds","idleItemIds","total_price","removeShopCartByIds","$router","push","path","query","id","$message","error","msg","catch","e","toggleSelection","rows","_this3","forEach","row","$refs","multipleTable","toggleRowSelection","clearSelection","handleSelectionChange","val","multipleSelection","length","i","favoriteId","countTotal","arr","keyName","$total","reduce","currentValue","currentIndex","removeShopCart","index","_this4","deleteFavorite","message","type","splice","_this5","pictureList","JSON","parse","idleItem","imgUrl","idleName","idleDetails","timeStr","createTime","idlePrice","idleStatus"],"sources":["src/components/page/shopCart.vue"],"sourcesContent":["<template>\n    <app-body>\n        <app-head></app-head>\n        <div class='shopCart-header'>\n            <el-button @click=\"toggleSelection(dataList)\">全选</el-button>\n            <el-button @click=\"toggleSelection()\">取消选择</el-button>\n        </div>\n        <el-table\n            ref=\"multipleTable\"\n            :data=\"dataList\"\n            tooltip-effect=\"dark\"\n            class='el-table-cart'\n            @selection-change=\"handleSelectionChange\">\n            <el-table-column\n                type=\"selection\"\n                width=\"55\">\n            </el-table-column>\n            <el-table-column\n                label=\"商品图片\"\n                width=\"400%\">\n                <template slot-scope=\"scope\">\n                    <div class=\"info\">\n                        <div class=\"pic\">\n                            <img :src=\"scope.row.imgUrl\" alt=\"商品图片\" width=\"150px\">\n                        </div>\n                    </div>\n                </template>\n            </el-table-column>\n            <el-table-column\n                prop=\"idleName\"\n                label=\"商品名称\"\n                width=\"200px\">\n            </el-table-column>\n            <el-table-column\n                prop=\"idlePrice\"\n                label=\"商品价格\"\n                width=\"200px\">\n            </el-table-column>\n            <el-table-column\n                prop=\"idleDetails\"\n                label=\"商品描述\"\n                width=\"200px\">\n            </el-table-column>\n            <el-table-column\n                prop=\"idlePlace\"\n                label=\"商品所在地\"\n                width=\"200px\">\n            </el-table-column>\n            <el-table-column\n                label=\"操作\"\n                width=\"200px\">\n                <template slot-scope=\"scope\">\n                    <el-button icon=\"el-icon-delete\"\n                               @click=\"removeShopCart(scope.row,scope.index)\">删除</el-button>\n                </template>\n            </el-table-column>\n        </el-table>\n\n        <div class='pay'>\n            <div>所 选 总 价 ： {{total}}</div>\n            <el-button icon='el-icon' @click=\"payAll()\">支 付</el-button>\n        </div>\n        <app-foot></app-foot>\n    </app-body>\n\n</template>\n\n<script>\nimport AppHead from '@/components/common/AppHeader.vue';\nimport AppBody from '@/components/common/AppPageBody.vue';\nimport AppFoot from '@/components/common/AppFoot.vue';\n\nexport default {\n\n    name: \"shopCart\",\n    components: {\n        AppHead,\n        AppBody,\n        AppFoot\n    },\n    data() {\n        return {\n            isShowTip: false,\n            tipContent: \"\",\n            dataList: [],\n            idlePlace: '',\n            total: 0,\n            idleItemids:[],\n            favoriteIds:[]\n        }\n    },\n\n    mounted() {\n    },\n    created() {\n\n        if (!this.$globalData.userInfo.nickname) {\n            this.$api.getUserInfo().then(res => {\n                if (res.status_code === 1) {\n                    res.data.signInTime = res.data.signInTime.substring(0, 10);\n                    console.log(res.data);\n                    this.$globalData.userInfo = res.data;\n                    this.userInfo = this.$globalData.userInfo;\n                }\n            })\n        } else {\n            this.userInfo = this.$globalData.userInfo;\n            console.log(this.userInfo);\n        }\n        this.getMyFavorite()\n        this.getIdleItemData()\n    },\n    computed: {\n    },\n\n    methods: {\n\n        /*支付功能*/\n        payAll(){\n            this.$api.addOrderByIds({\n                idleItemIds:this.idleItemids,\n                total_price:this.total,\n            }).then(res=>{\n                console.log(res);\n                if(res.status_code===1){\n                    this.$api.removeShopCartByIds({\n                        favoriteIds: this.favoriteIds\n                    }).then(res=>{\n                        // alert(\"支付成功，商品已经从购物车中移出\")\n                    })\n                    this.$router.push({path: '/order', query: {id: res.data.id}});\n                }else {\n                    this.$message.error(res.msg)\n                }\n            }).catch(e=>{\n\n            })\n        },\n        /*多选框*/\n        toggleSelection(rows) {\n            if (rows) {\n                rows.forEach(row => {\n                    this.$refs.multipleTable.toggleRowSelection(row);\n                });\n            } else {\n                this.$refs.multipleTable.clearSelection();\n            }\n        },\n        handleSelectionChange(val) {\n            this.multipleSelection = val;\n            console.log(val)\n\n            /*计算勾选总价*/\n            if (val.length !== 0) {\n                for (var i = 0; i < val.length; i++){\n                    this.idleItemids[i] = val[i].id;\n                    this.favoriteIds[i] = val[i].favoriteId;\n                }\n\n                console.log(this.idleItemids,this.favoriteIds)\n                this.total = this.countTotal(val, 'idlePrice')\n            }else{\n                this.total = 0\n            }\n        },\n        countTotal(arr, keyName) {\n            let $total = 0\n            $total = arr.reduce(function(total, currentValue, currentIndex, arr) {\n                return currentValue[keyName] ? (total + currentValue[keyName]) : total\n            }, 0)\n            return $total\n        },\n        removeShopCart(row, index) {\n            this.$api.deleteFavorite({\n                id: row.favoriteId\n            }).then(res => {\n                console.log(res);\n                console.log(row)\n                // console.log(\"列表的数据\"+ row.id);\n                if (res.status_code === 1) {\n                    this.$message({\n                        message: '已取消购物车！',\n                        type: 'success'\n                    });\n                    this.dataList.splice(index, 1);\n                    // this.getMyFavorite()\n                } else {\n                    this.$message.error(res.msg)\n                }\n                // this.getMyFavorite()\n            })\n        },\n        /*获取购物车内容*/\n        getMyFavorite() {\n            this.$api.getMyFavorite().then(res => {\n                console.log('getMyFavorite', res);\n                if (res.status_code === 1) {\n                    for (let i = 0; i < res.data.length; i++) {\n                        let pictureList = JSON.parse(res.data[i].idleItem.pictureList);\n                        this.dataList.push({\n                            favoriteId: res.data[i].id,\n                            id: res.data[i].idleItem.id,\n                            imgUrl: pictureList.length > 0 ? pictureList[0] : '',\n                            idleName: res.data[i].idleItem.idleName,\n                            idleDetails: res.data[i].idleItem.idleDetails,\n                            timeStr: res.data[i].createTime.substring(0, 10) + \" \" + res.data[i].createTime.substring(11, 19),\n                            idlePrice: res.data[i].idleItem.idlePrice,\n                            idleStatus: res.data[i].idleItem.idleStatus\n                        });\n                        this.idlePlace = res.data[i].idleItem.idlePlace\n                    }\n                }\n            })\n        }\n}\n\n}\n\n</script>\n<style>\n    .shopCart-header{\n        margin-top: 30px;\n        width: auto;\n        padding-left: 7%;\n        height: 7%;\n    }\n    .el-table-cart{\n        width: 100%;\n        padding-left: 10%;\n    }\n</style>"],"mappings":"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","ignoreList":[]}]}