{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/thread-loader/dist/cjs.js!/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js!/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/page/me.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/page/me.vue","mtime":1741743644073},{"path":"/Users/macos/Desktop/-Second-hand-mall/babel.config.js","mtime":1741743639580},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/thread-loader/dist/cjs.js","mtime":1741743643599},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js","mtime":1741743640250},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["import AppHead from \"../common/AppHeader.vue\";\nimport AppBody from \"../common/AppPageBody.vue\";\nimport AppFoot from \"../common/AppFoot.vue\";\nimport options from \"../common/country-data.js\";\nexport default {\n  name: \"me\",\n  components: {\n    AppHead: AppHead,\n    AppBody: AppBody,\n    AppFoot: AppFoot\n  },\n  data: function data() {\n    return {\n      imgFileList: [],\n      addressInfo: {\n        consigneeName: '',\n        consigneePhone: '',\n        provinceName: '',\n        cityName: '',\n        regionName: '',\n        detailAddress: '',\n        defaultFlag: false\n      },\n      activeName: '1',\n      handleName: ['下架', '删除', '取消收藏', '', ''],\n      dataList: [[], [], [], [], [], [], [], []],\n      orderStatus: ['待付款', '待发货', '待收货', '已完成', '已取消'],\n      userInfoDialogVisible: false,\n      notUserNicknameEdit: true,\n      userPasswordEdit: false,\n      userPassword1: '',\n      userPassword2: '',\n      userPassword3: '',\n      eidtAddress: false,\n      selectedOptions: [],\n      //存放默认值\n      options: options,\n      //存放城市数据,\n      userInfo: {\n        accountNumber: \"\",\n        avatar: \"\",\n        nickname: \"\",\n        signInTime: \"\"\n      },\n      addressData: []\n    };\n  },\n  created: function created() {\n    var _this = this;\n    if (!this.$globalData.userInfo.nickname) {\n      this.$api.getUserInfo().then(function (res) {\n        if (res.status_code === 1) {\n          res.data.signInTime = res.data.signInTime.substring(0, 10);\n          console.log(res.data);\n          _this.$globalData.userInfo = res.data;\n          _this.userInfo = _this.$globalData.userInfo;\n        }\n      });\n    } else {\n      this.userInfo = this.$globalData.userInfo;\n      console.log(this.userInfo);\n    }\n    this.getAddressData();\n    this.getIdleItemData();\n    this.getMyOrder();\n    this.getMySoldIdle();\n    this.getMyFavorite();\n  },\n  methods: {\n    getMyFavorite: function getMyFavorite() {\n      var _this2 = this;\n      this.$api.getMyFavorite().then(function (res) {\n        console.log('getMyFavorite', res);\n        if (res.status_code === 1) {\n          for (var i = 0; i < res.data.length; i++) {\n            var pictureList = JSON.parse(res.data[i].idleItem.pictureList);\n            _this2.dataList[2].push({\n              favoriteId: res.data[i].id,\n              id: res.data[i].idleItem.id,\n              imgUrl: pictureList.length > 0 ? pictureList[0] : '',\n              idleName: res.data[i].idleItem.idleName,\n              idleDetails: res.data[i].idleItem.idleDetails,\n              timeStr: res.data[i].createTime.substring(0, 10) + \" \" + res.data[i].createTime.substring(11, 19),\n              idlePrice: res.data[i].idleItem.idlePrice\n            });\n          }\n        }\n      });\n    },\n    getMySoldIdle: function getMySoldIdle() {\n      var _this3 = this;\n      this.$api.getMySoldIdle().then(function (res) {\n        if (res.status_code === 1) {\n          console.log('getMySoldIdle', res.data);\n          for (var i = 0; i < res.data.length; i++) {\n            var pictureList = JSON.parse(res.data[i].idleItem.pictureList);\n            _this3.dataList[3].push({\n              id: res.data[i].id,\n              imgUrl: pictureList.length > 0 ? pictureList[0] : '',\n              idleName: res.data[i].idleItem.idleName,\n              idleDetails: res.data[i].idleItem.idleDetails,\n              timeStr: res.data[i].createTime.substring(0, 10) + \" \" + res.data[i].createTime.substring(11, 19),\n              idlePrice: res.data[i].orderPrice,\n              orderStatus: res.data[i].orderStatus\n            });\n          }\n        }\n      });\n    },\n    getMyOrder: function getMyOrder() {\n      var _this4 = this;\n      this.$api.getMyOrder().then(function (res) {\n        if (res.status_code === 1) {\n          console.log('getMyOrder', res.data);\n          for (var i = 0; i < res.data.length; i++) {\n            var pictureList = JSON.parse(res.data[i].idleItem.pictureList);\n            _this4.dataList[4].push({\n              id: res.data[i].id,\n              imgUrl: pictureList.length > 0 ? pictureList[0] : '',\n              idleName: res.data[i].idleItem.idleName,\n              idleDetails: res.data[i].idleItem.idleDetails,\n              timeStr: res.data[i].createTime.substring(0, 10) + \" \" + res.data[i].createTime.substring(11, 19),\n              idlePrice: res.data[i].orderPrice,\n              orderStatus: res.data[i].orderStatus\n            });\n          }\n        }\n      });\n    },\n    getIdleItemData: function getIdleItemData() {\n      var _this5 = this;\n      this.$api.getAllIdleItem().then(function (res) {\n        console.log(res);\n        if (res.status_code === 1) {\n          for (var i = 0; i < res.data.length; i++) {\n            res.data[i].timeStr = res.data[i].releaseTime.substring(0, 10) + \" \" + res.data[i].releaseTime.substring(11, 19);\n            var pictureList = JSON.parse(res.data[i].pictureList);\n            res.data[i].imgUrl = pictureList.length > 0 ? pictureList[0] : '';\n            if (res.data[i].idleStatus === 1) {\n              _this5.dataList[0].push(res.data[i]);\n            } else if (res.data[i].idleStatus === 2) {\n              _this5.dataList[1].push(res.data[i]);\n            }\n          }\n        }\n      });\n    },\n    getAddressData: function getAddressData() {\n      var _this6 = this;\n      this.$api.getAddress().then(function (res) {\n        if (res.status_code === 1) {\n          var data = res.data;\n          for (var i = 0; i < data.length; i++) {\n            data[i].detailAddressText = data[i].provinceName + data[i].cityName + data[i].regionName + data[i].detailAddress;\n            data[i].defaultAddress = data[i].defaultFlag ? '默认地址' : '设为默认';\n          }\n          console.log(data);\n          _this6.addressData = data;\n        }\n      });\n    },\n    handleClick: function handleClick(tab, event) {\n      // console.log(tab, event);\n      console.log(this.activeName);\n    },\n    saveUserNickname: function saveUserNickname() {\n      var _this7 = this;\n      this.notUserNicknameEdit = true;\n      this.$api.updateUserPublicInfo({\n        nickname: this.userInfo.nickname\n      }).then(function (res) {\n        console.log(res);\n        _this7.$globalData.userInfo.nickname = _this7.userInfo.nickname;\n      });\n    },\n    savePassword: function savePassword() {\n      var _this8 = this;\n      if (!this.userPassword1 || !this.userPassword2) {\n        this.$message.error('密码为空！');\n      } else if (this.userPassword2 === this.userPassword3) {\n        this.$api.updatePassword({\n          oldPassword: this.userPassword1,\n          newPassword: this.userPassword2\n        }).then(function (res) {\n          if (res.status_code === 1) {\n            _this8.userPasswordEdit = false;\n            _this8.$message({\n              message: '修改成功！',\n              type: 'success'\n            });\n            _this8.userPassword1 = '';\n            _this8.userPassword2 = '';\n            _this8.userPassword3 = '';\n          } else {\n            _this8.$message.error('旧密码错误，修改失败！');\n          }\n        });\n      } else {\n        this.$message.error('两次输入的密码不一致！');\n      }\n    },\n    finishEdit: function finishEdit() {\n      this.notUserNicknameEdit = true;\n      this.userInfoDialogVisible = false;\n      this.userPasswordEdit = false;\n    },\n    handleAddressChange: function handleAddressChange(value) {\n      console.log(value);\n      this.addressInfo.provinceName = value[0];\n      this.addressInfo.cityName = value[1];\n      this.addressInfo.regionName = value[2];\n    },\n    handleEdit: function handleEdit(index, row) {\n      console.log(index, row);\n      this.addressInfo = JSON.parse(JSON.stringify(row));\n      this.selectedOptions = ['', '', ''];\n      this.selectedOptions[0] = row.provinceName;\n      this.selectedOptions[1] = row.cityName;\n      this.selectedOptions[2] = row.regionName;\n    },\n    handleDelete: function handleDelete(index, row) {\n      var _this9 = this;\n      console.log(index, row);\n      this.$confirm('是否确定删除该地址?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this9.$api.deleteAddress(row).then(function (res) {\n          if (res.status_code === 1) {\n            _this9.$message({\n              message: '删除成功！',\n              type: 'success'\n            });\n            _this9.addressData.splice(index, 1);\n            if (row.defaultFlag && _this9.addressData.length > 0) {\n              _this9.addressData[0].defaultFlag = true;\n              _this9.addressData[0].defaultAddress = '默认地址';\n              _this9.update({\n                id: _this9.addressData[0].id,\n                defaultFlag: true\n              });\n            }\n          } else {\n            _this9.$message.error('系统异常，删除失败！');\n          }\n        }).catch(function () {\n          _this9.$message.error('网络异常！');\n        });\n      }).catch(function () {});\n    },\n    handleSetDefault: function handleSetDefault(index, row) {\n      console.log(index, row);\n      row.defaultFlag = true;\n      this.update(row);\n    },\n    toDetails: function toDetails(activeName, item) {\n      if (activeName === '4' || activeName === '5') {\n        this.$router.push({\n          path: '/order',\n          query: {\n            id: item.id\n          }\n        });\n      } else {\n        this.$router.push({\n          path: '/details',\n          query: {\n            id: item.id\n          }\n        });\n      }\n    },\n    /*\n        个人简介页面中商品的各种按钮功能实现\n    */\n    handle: function handle(activeName, item, index) {\n      var _this10 = this;\n      console.log(activeName, item, index);\n      this.$confirm('是否确认？', '提示', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        if (activeName === '1') {\n          _this10.$api.updateIdleItem({\n            id: item.id,\n            idleStatus: 2\n          }).then(function (res) {\n            console.log(res);\n            if (res.status_code === 1) {\n              _this10.dataList[0].splice(index, 1);\n              item.idleStatus = 2;\n              _this10.dataList[1].unshift(item);\n            } else {\n              _this10.$message.error(res.msg);\n            }\n          });\n        } else if (activeName === '2') {\n          _this10.$api.updateIdleItem({\n            id: item.id,\n            idleStatus: 0\n          }).then(function (res) {\n            console.log(res);\n            if (res.status_code === 1) {\n              _this10.dataList[1].splice(index, 1);\n            } else {\n              _this10.$message.error(res.msg);\n            }\n          });\n        } else if (activeName === '3') {\n          _this10.$api.deleteFavorite({\n            id: item.favoriteId\n          }).then(function (res) {\n            console.log(res);\n            if (res.status_code === 1) {\n              _this10.$message({\n                message: '已取消收藏！',\n                type: 'success'\n              });\n              _this10.dataList[2].splice(index, 1);\n            } else {\n              _this10.$message.error(res.msg);\n            }\n          }).catch(function (e) {});\n        }\n      });\n    },\n    fileHandleSuccess: function fileHandleSuccess(response, file, fileList) {\n      var _this11 = this;\n      console.log(\"file:\", response, file, fileList);\n      var imgUrl = response.data;\n      this.imgFileList = [];\n      this.$api.updateUserPublicInfo({\n        avatar: imgUrl\n      }).then(function (res) {\n        console.log(res);\n        _this11.userInfo.avatar = imgUrl;\n        _this11.$globalData.userInfo.avatar = imgUrl;\n      });\n    },\n    update: function update(data) {\n      var _this12 = this;\n      this.$api.updateAddress(data).then(function (res) {\n        if (res.status_code === 1) {\n          _this12.getAddressData();\n          _this12.$message({\n            message: '修改成功！',\n            type: 'success'\n          });\n        } else {\n          _this12.$message.error('系统异常，修改失败！');\n        }\n      }).catch(function () {\n        _this12.$message.error('网络异常！');\n      });\n    },\n    saveAddress: function saveAddress() {\n      var _this13 = this;\n      if (this.addressInfo.id) {\n        console.log('update:', this.addressInfo);\n        this.update(this.addressInfo);\n        this.addressInfo = {\n          consigneeName: '',\n          consigneePhone: '',\n          provinceName: '',\n          cityName: '',\n          regionName: '',\n          detailAddress: '',\n          defaultFlag: false\n        };\n        this.selectedOptions = [];\n      } else {\n        if (this.addressData.length >= 5) {\n          this.$message.error('已达到最大地址数量！');\n        } else {\n          console.log(this.addressInfo);\n          this.$api.addAddress(this.addressInfo).then(function (res) {\n            if (res.status_code === 1) {\n              _this13.getAddressData();\n              _this13.$message({\n                message: '新增成功！',\n                type: 'success'\n              });\n              _this13.selectedOptions = [];\n              _this13.addressInfo = {\n                consigneeName: '',\n                consigneePhone: '',\n                provinceName: '',\n                cityName: '',\n                regionName: '',\n                detailAddress: '',\n                defaultFlag: false\n              };\n            } else {\n              _this13.$message.error('系统异常，新增失败！');\n            }\n          }).catch(function (e) {\n            _this13.$message.error('网络异常！');\n          });\n        }\n      }\n    }\n  }\n};",null]}