{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-87391838\"],{\"0013\":function(t,e,a){\"use strict\";a(\"4d47\")},\"2fb8\":function(t,e,a){\"use strict\";a(\"df56\")},\"4d47\":function(t,e,a){},\"4fc4\":function(t,e,a){\"use strict\";var i=function(){var t=this,e=t._self._c;return e(\"div\",{staticClass:\"page-body\"},[e(\"div\",{staticClass:\"page-content\"},[t._t(\"default\")],2)])},s=[],o={name:\"AppPageBody\"},n=o,l=(a(\"0013\"),a(\"2877\")),r=Object(l[\"a\"])(n,i,s,!1,null,\"4f6f044f\",null);e[\"a\"]=r.exports},\"5d9e\":function(t,e,a){\"use strict\";a.r(e);var i=function(){var t=this,e=t._self._c;return e(\"app-body\",[e(\"app-head\"),e(\"div\",{staticClass:\"shopCart-header\"},[e(\"el-button\",{on:{click:function(e){return t.toggleSelection(t.dataList)}}},[t._v(\"全选\")]),e(\"el-button\",{on:{click:function(e){return t.toggleSelection()}}},[t._v(\"取消选择\")])],1),e(\"el-table\",{ref:\"multipleTable\",staticClass:\"el-table-cart\",attrs:{data:t.dataList,\"tooltip-effect\":\"dark\"},on:{\"selection-change\":t.handleSelectionChange}},[e(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}),e(\"el-table-column\",{attrs:{label:\"商品图片\",width:\"400%\"},scopedSlots:t._u([{key:\"default\",fn:function(t){return[e(\"div\",{staticClass:\"info\"},[e(\"div\",{staticClass:\"pic\"},[e(\"img\",{attrs:{src:t.row.imgUrl,alt:\"商品图片\",width:\"150px\"}})])])]}}])}),e(\"el-table-column\",{attrs:{prop:\"idleName\",label:\"商品名称\",width:\"200px\"}}),e(\"el-table-column\",{attrs:{prop:\"idlePrice\",label:\"商品价格\",width:\"200px\"}}),e(\"el-table-column\",{attrs:{prop:\"idleDetails\",label:\"商品描述\",width:\"200px\"}}),e(\"el-table-column\",{attrs:{prop:\"idlePlace\",label:\"商品所在地\",width:\"200px\"}}),e(\"el-table-column\",{attrs:{label:\"操作\",width:\"200px\"},scopedSlots:t._u([{key:\"default\",fn:function(a){return[e(\"el-button\",{attrs:{icon:\"el-icon-delete\"},on:{click:function(e){return t.removeShopCart(a.row,a.index)}}},[t._v(\"删除\")])]}}])})],1),e(\"div\",{staticClass:\"pay\"},[e(\"div\",[t._v(\"所 选 总 价 ： \"+t._s(t.total))]),e(\"el-button\",{attrs:{icon:\"el-icon\"},on:{click:function(e){return t.payAll()}}},[t._v(\"支 付\")])],1),e(\"app-foot\")],1)},s=[],o=(a(\"ac6a\"),a(\"6e70\")),n=a(\"4fc4\"),l=a(\"85a9\"),r={name:\"shopCart\",components:{AppHead:o[\"a\"],AppBody:n[\"a\"],AppFoot:l[\"a\"]},data:function(){return{isShowTip:!1,tipContent:\"\",dataList:[],idlePlace:\"\",total:0,idleItemids:[],favoriteIds:[]}},mounted:function(){},created:function(){var t=this;this.$globalData.userInfo.nickname?(this.userInfo=this.$globalData.userInfo,console.log(this.userInfo)):this.$api.getUserInfo().then((function(e){1===e.status_code&&(e.data.signInTime=e.data.signInTime.substring(0,10),console.log(e.data),t.$globalData.userInfo=e.data,t.userInfo=t.$globalData.userInfo)})),this.getMyFavorite(),this.getIdleItemData()},computed:{},methods:{payAll:function(){var t=this;this.$api.addOrderByIds({idleItemIds:this.idleItemids,total_price:this.total}).then((function(e){console.log(e),1===e.status_code?(t.$api.removeShopCartByIds({favoriteIds:t.favoriteIds}).then((function(t){})),t.$router.push({path:\"/order\",query:{id:e.data.id}})):t.$message.error(e.msg)})).catch((function(t){}))},toggleSelection:function(t){var e=this;t?t.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){if(this.multipleSelection=t,console.log(t),0!==t.length){for(var e=0;e<t.length;e++)this.idleItemids[e]=t[e].id,this.favoriteIds[e]=t[e].favoriteId;console.log(this.idleItemids,this.favoriteIds),this.total=this.countTotal(t,\"idlePrice\")}else this.total=0},countTotal:function(t,e){var a=0;return a=t.reduce((function(t,a,i,s){return a[e]?t+a[e]:t}),0),a},removeShopCart:function(t,e){var a=this;this.$api.deleteFavorite({id:t.favoriteId}).then((function(i){console.log(i),console.log(t),1===i.status_code?(a.$message({message:\"已取消购物车！\",type:\"success\"}),a.dataList.splice(e,1)):a.$message.error(i.msg)}))},getMyFavorite:function(){var t=this;this.$api.getMyFavorite().then((function(e){if(console.log(\"getMyFavorite\",e),1===e.status_code)for(var a=0;a<e.data.length;a++){var i=JSON.parse(e.data[a].idleItem.pictureList);t.dataList.push({favoriteId:e.data[a].id,id:e.data[a].idleItem.id,imgUrl:i.length>0?i[0]:\"\",idleName:e.data[a].idleItem.idleName,idleDetails:e.data[a].idleItem.idleDetails,timeStr:e.data[a].createTime.substring(0,10)+\" \"+e.data[a].createTime.substring(11,19),idlePrice:e.data[a].idleItem.idlePrice,idleStatus:e.data[a].idleItem.idleStatus}),t.idlePlace=e.data[a].idleItem.idlePlace}}))}}},c=r,d=(a(\"bd38\"),a(\"2877\")),u=Object(d[\"a\"])(c,i,s,!1,null,null,null);e[\"default\"]=u.exports},\"654b\":function(t,e,a){},\"6e70\":function(t,e,a){\"use strict\";var i=function(){var t=this,e=t._self._c;return e(\"div\",{staticClass:\"header\"},[e(\"div\",{staticClass:\"header-container\"},[e(\"div\",{staticClass:\"app-name\"},[e(\"router-link\",{attrs:{to:\"/\"}},[e(\"img\",{staticClass:\"logo-image\",attrs:{src:t.logoPath}}),e(\"span\",{staticClass:\"logo-text\"},[t._v(\"校易购\")])])],1),e(\"div\",{staticClass:\"search-container\"},[e(\"el-input\",{staticClass:\"search-input\",attrs:{placeholder:\"搜闲置...\",\"prefix-icon\":\"el-icon-search\"},nativeOn:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.searchIdle.apply(null,arguments)}},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:\"searchValue\"}},[e(\"el-button\",{attrs:{slot:\"append\",icon:\"el-icon-search\"},on:{click:t.searchIdle},slot:\"append\"})],1)],1),e(\"div\",{staticClass:\"action-buttons\"},[e(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-plus\"},on:{click:t.toRelease}},[t._v(\"发布闲置/公告\")]),e(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-chat-dot-round\"},on:{click:t.toMessage}},[t._v(\"\\n                消息\\n                \"),t.unreadMessagesCount>0?e(\"el-badge\",{staticClass:\"message-badge\",attrs:{value:t.unreadMessagesCount}}):t._e()],1),t.isLogin?e(\"el-dropdown\",{attrs:{trigger:\"click\"}},[e(\"div\",{staticClass:\"user-profile\"},[e(\"div\",{staticClass:\"user-nickname\"},[t._v(t._s(t.nickname))]),e(\"el-avatar\",{attrs:{src:t.avatar,size:32}})],1),e(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[e(\"el-dropdown-item\",[e(\"div\",{on:{click:t.toMe}},[t._v(\"个人中心\")])]),e(\"el-dropdown-item\",{staticClass:\"logout-item\",attrs:{divided:\"\"}},[e(\"div\",{on:{click:t.loginOut}},[t._v(\"退出登录\")])])],1)],1):e(\"router-link\",{staticClass:\"user-name-text\",attrs:{to:\"/login\"}},[t._v(\"登录\")])],1)])])},s=[],o=(a(\"a481\"),{width:\"1\",height:\"1\"}),n=1920,l=1080,r=parseFloat((n/l).toFixed(5)),c={data:function(){return{drawTiming:null}},mounted:function(){this.calcRate(),window.addEventListener(\"resize\",this.resize)},beforeDestroy:function(){window.removeEventListener(\"resize\",this.resize)},methods:{calcRate:function(){var t=this.$refs[\"zoom\"];if(t){var e=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));t&&(e>r?(o.width=(window.innerHeight*r/n).toFixed(5),o.height=(window.innerHeight/l).toFixed(5),t.style.transform=\"scale(\".concat(o.width,\", \").concat(o.height,\") translate(-50%, -50%)\")):(o.height=(window.innerWidth/r/l).toFixed(5),o.width=(window.innerWidth/n).toFixed(5),t.style.transform=\"scale(\".concat(o.width,\", \").concat(o.height,\") translate(-50%, -50%)\")))}},resize:function(){var t=this;clearTimeout(this.drawTiming),this.drawTiming=setTimeout((function(){t.calcRate()}),200)}}},d={mixins:[c],name:\"Header\",props:[\"searchInput\",\"nicknameValue\",\"avatarValue\"],data:function(){return{logoPath:\"/logo.png\",searchValue:this.searchInput,nickname:\"登录\",avatar:\"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png\",isLogin:!1,unreadMessagesCount:3}},created:function(){var t=this;this.$globalData.userInfo.nickname?(this.nickname=this.$globalData.userInfo.nickname,this.avatar=this.$globalData.userInfo.avatar,this.isLogin=!0):this.$api.getUserInfo().then((function(e){console.log(\"Header getUserInfo:\",e),1===e.status_code&&(t.nickname=e.data.nickname,t.avatar=e.data.avatar,e.data.signInTime=e.data.signInTime.substring(0,10),t.$globalData.userInfo=e.data,t.isLogin=!0)}))},methods:{searchIdle:function(){\"/search\"!==this.$route.path?this.$router.push({path:\"/search\",query:{searchValue:this.searchValue}}):(this.$router.replace({path:\"/search\",query:{searchValue:this.searchValue}}),this.$router.go(0))},toMe:function(){\"/me\"!==this.$route.path&&this.$router.push({path:\"/me\"})},toMessage:function(){\"/message\"!==this.$route.path&&this.$router.push({path:\"/message\"})},toRelease:function(){\"/release\"!==this.$route.path&&this.$router.push({path:\"/release\"})},loginOut:function(){var t=this;this.$api.logout().then((function(e){1===e.status_code?(t.$globalData.userInfo={},console.log(\"login out\"),\"/index\"===t.$route.path?t.$router.go(0):t.$router.push({path:\"/index\"})):t.$message.error(\"网络或系统异常，退出登录失败！\")}))}}},u=d,h=(a(\"efb4\"),a(\"2877\")),p=Object(h[\"a\"])(u,i,s,!1,null,\"6eb184ee\",null);e[\"a\"]=p.exports},\"85a9\":function(t,e,a){\"use strict\";var i=function(){var t=this,e=t._self._c;return e(\"footer\",{staticClass:\"footer\"},[e(\"div\",{staticClass:\"footer-content\"},[t._m(0),e(\"div\",{staticClass:\"footer-copyright\"},[e(\"p\",[t._v(\"© \"+t._s(t.currentYear)+\" 校易购 - 毕业设计项目\")])])])])},s=[function(){var t=this,e=t._self._c;return e(\"div\",{staticClass:\"footer-main\"},[e(\"div\",{staticClass:\"footer-section\"},[e(\"h3\",{staticClass:\"footer-title\"},[t._v(\"校易购\")]),e(\"p\",{staticClass:\"footer-desc\"},[t._v(\"校园闲置物品交易平台 - 让闲置焕发新生\")])]),e(\"div\",{staticClass:\"footer-section\"},[e(\"h3\",{staticClass:\"footer-title\"},[t._v(\"联系我们\")]),e(\"p\",{staticClass:\"footer-contact\"},[e(\"i\",{staticClass:\"el-icon-message\"}),t._v(\" contact@schoolbuy.com\")]),e(\"p\",{staticClass:\"footer-contact\"},[e(\"i\",{staticClass:\"el-icon-phone\"}),t._v(\" 010-12345678\")])])])}],o={name:\"AppFoot\",computed:{currentYear:function(){return(new Date).getFullYear()}}},n=o,l=(a(\"2fb8\"),a(\"2877\")),r=Object(l[\"a\"])(n,i,s,!1,null,\"3a7c975e\",null);e[\"a\"]=r.exports},bd38:function(t,e,a){\"use strict\";a(\"654b\")},c174:function(t,e,a){},df56:function(t,e,a){},efb4:function(t,e,a){\"use strict\";a(\"c174\")}}]);","extractedComments":[]}