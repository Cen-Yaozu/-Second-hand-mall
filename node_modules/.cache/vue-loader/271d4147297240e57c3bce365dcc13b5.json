{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/page/donation-detail.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/page/donation-detail.vue","mtime":1742002741026},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js","mtime":1741743640250},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["\nimport AppHead from '../common/AppHeader.vue';\nimport AppBody from '../common/AppPageBody.vue';\nimport AppFoot from '../common/AppFoot.vue';\n\nexport default {\n  name: 'donation-detail',\n  components: {\n    AppHead,\n    AppBody,\n    AppFoot\n  },\n  data() {\n    return {\n      loading: false,\n      donationRequest: null\n    };\n  },\n  created() {\n    this.loadDonationDetail();\n  },\n  methods: {\n    loadDonationDetail() {\n      const requestId = this.$route.query.id;\n      if (!requestId) {\n        this.$message.error('缺少请求ID参数');\n        return;\n      }\n      \n      this.loading = true;\n      this.$api.getDonationRequestDetail(requestId).then(res => {\n        if (res.data) {\n          this.donationRequest = res.data;\n        } else {\n          this.$message.error('未找到捐赠请求信息');\n        }\n      }).catch(err => {\n        console.error('获取捐赠详情失败', err);\n        this.$message.error('获取捐赠详情失败');\n      }).finally(() => {\n        this.loading = false;\n      });\n    },\n    getStatusTag(status) {\n      const statusMap = {\n        0: { type: 'info', text: '待审核' },\n        1: { type: 'success', text: '已接受' },\n        2: { type: 'danger', text: '已拒绝' },\n        3: { type: 'primary', text: '已完成' }\n      };\n      return statusMap[status] || { type: 'info', text: '未知状态' };\n    },\n    cancelDonation() {\n      this.$confirm('确定要取消此捐赠请求吗?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$api.cancelDonationRequest(this.donationRequest.id).then(res => {\n          if (res.status_code === 1) {\n            this.$message.success('捐赠请求已取消');\n            this.loadDonationDetail();\n          } else {\n            this.$message.error(res.msg || '操作失败');\n          }\n        }).catch(err => {\n          console.error('取消捐赠请求失败', err);\n          this.$message.error('取消捐赠请求失败');\n        });\n      }).catch(() => {\n        // 取消操作\n      });\n    },\n    goBack() {\n      this.$router.push('/donation/my-requests');\n    },\n    getImageUrl(url) {\n      // 检查url是否已经是HTTP URL\n      if (url && (url.startsWith('http://') || url.startsWith('https://'))) {\n        return url;\n      }\n      \n      // 检查url是否是一个本地文件路径\n      if (url && (url.startsWith('/') || url.startsWith('D:') || url.includes('\\\\') || url.includes('/'))) {\n        // 如果是本地路径，则转换为服务器URL\n        // 这里假设文件名是路径最后的部分\n        const fileName = url.split(/[/\\\\]/).pop();\n        // 构建访问URL\n        return `http://localhost:8082/image?imageName=${fileName}`;\n      }\n      \n      // 如果是简单的文件名，直接构建访问URL\n      if (url && url.trim() !== '') {\n        return `http://localhost:8082/image?imageName=${url}`;\n      }\n      \n      // 其他情况直接返回\n      return url;\n    }\n  }\n};\n",{"version":3,"sources":["donation-detail.vue"],"names":[],"mappings":";AAiHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"donation-detail.vue","sourceRoot":"src/components/page","sourcesContent":["<template>\n  <div>\n    <app-head></app-head>\n    <app-body>\n      <div class=\"donation-detail-container\">\n        <div v-loading=\"loading\">\n          <div v-if=\"!donationRequest\" class=\"empty-detail\">\n            <i class=\"el-icon-warning-outline\"></i>\n            <p>未找到捐赠请求信息</p>\n            <el-button type=\"primary\" @click=\"goBack\">返回</el-button>\n          </div>\n          \n          <div v-else>\n            <div class=\"detail-header\">\n              <div class=\"header-left\">\n                <h2>捐赠详情</h2>\n                <el-tag :type=\"getStatusTag(donationRequest.status).type\">{{ getStatusTag(donationRequest.status).text }}</el-tag>\n              </div>\n              <div class=\"header-right\">\n                <el-button type=\"primary\" icon=\"el-icon-back\" @click=\"goBack\">返回</el-button>\n              </div>\n            </div>\n            \n            <el-card class=\"detail-card\">\n              <div class=\"detail-section\">\n                <h3>基本信息</h3>\n                <el-row :gutter=\"20\">\n                  <el-col :span=\"12\">\n                    <div class=\"detail-item\">\n                      <span class=\"label\">申请编号：</span>\n                      <span>{{ donationRequest.id }}</span>\n                    </div>\n                  </el-col>\n                  <el-col :span=\"12\">\n                    <div class=\"detail-item\">\n                      <span class=\"label\">申请时间：</span>\n                      <span>{{ donationRequest.createTime }}</span>\n                    </div>\n                  </el-col>\n                  <el-col :span=\"12\">\n                    <div class=\"detail-item\">\n                      <span class=\"label\">捐赠类型：</span>\n                      <el-tag size=\"small\" type=\"success\" v-if=\"donationRequest.donationType === 0\">公益捐赠</el-tag>\n                      <el-tag size=\"small\" type=\"warning\" v-else>环保回收</el-tag>\n                    </div>\n                  </el-col>\n                  <el-col :span=\"12\">\n                    <div class=\"detail-item\">\n                      <span class=\"label\">当前状态：</span>\n                      <el-tag :type=\"getStatusTag(donationRequest.status).type\">{{ getStatusTag(donationRequest.status).text }}</el-tag>\n                    </div>\n                  </el-col>\n                </el-row>\n              </div>\n              \n              <el-divider></el-divider>\n              \n              <div class=\"detail-section\">\n                <h3>物品信息</h3>\n                <div class=\"item-detail\">\n                  <div class=\"item-image\">\n                    <img :src=\"getImageUrl(donationRequest.item.pictureList[0])\" alt=\"物品图片\">\n                  </div>\n                  <div class=\"item-info\">\n                    <h4>{{ donationRequest.item.idleName }}</h4>\n                    <div class=\"item-price\">¥{{ donationRequest.item.idlePrice }}</div>\n                    <div class=\"item-description\">{{ donationRequest.item.idleDetails }}</div>\n                  </div>\n                </div>\n              </div>\n              \n              <el-divider></el-divider>\n              \n              <div class=\"detail-section\">\n                <h3>捐赠理由</h3>\n                <div class=\"reason-content\">{{ donationRequest.donationReason }}</div>\n              </div>\n              \n              <el-divider v-if=\"donationRequest.adminFeedback\"></el-divider>\n              \n              <div class=\"detail-section\" v-if=\"donationRequest.adminFeedback\">\n                <h3>管理员反馈</h3>\n                <div class=\"feedback-content\">{{ donationRequest.adminFeedback }}</div>\n              </div>\n              \n              <el-divider v-if=\"donationRequest.status === 1\"></el-divider>\n              \n              <div class=\"detail-section\" v-if=\"donationRequest.status === 1\">\n                <h3>捐赠流程</h3>\n                <div class=\"process-info\">\n                  <p><i class=\"el-icon-info\"></i> 您的捐赠请求已被接受，请按照以下步骤完成捐赠：</p>\n                  <ol>\n                    <li>请将物品打包好，确保物品完好无损</li>\n                    <li>工作人员将与您联系，安排物品交接事宜</li>\n                    <li>完成物品交接后，捐赠流程将标记为已完成</li>\n                    <li>您将收到捐赠证书或回收凭证（如适用）</li>\n                  </ol>\n                </div>\n              </div>\n              \n              <div class=\"detail-actions\" v-if=\"donationRequest.status === 0\">\n                <el-button type=\"danger\" @click=\"cancelDonation\">取消捐赠</el-button>\n              </div>\n            </el-card>\n          </div>\n        </div>\n      </div>\n    </app-body>\n    <app-foot></app-foot>\n  </div>\n</template>\n\n<script>\nimport AppHead from '../common/AppHeader.vue';\nimport AppBody from '../common/AppPageBody.vue';\nimport AppFoot from '../common/AppFoot.vue';\n\nexport default {\n  name: 'donation-detail',\n  components: {\n    AppHead,\n    AppBody,\n    AppFoot\n  },\n  data() {\n    return {\n      loading: false,\n      donationRequest: null\n    };\n  },\n  created() {\n    this.loadDonationDetail();\n  },\n  methods: {\n    loadDonationDetail() {\n      const requestId = this.$route.query.id;\n      if (!requestId) {\n        this.$message.error('缺少请求ID参数');\n        return;\n      }\n      \n      this.loading = true;\n      this.$api.getDonationRequestDetail(requestId).then(res => {\n        if (res.data) {\n          this.donationRequest = res.data;\n        } else {\n          this.$message.error('未找到捐赠请求信息');\n        }\n      }).catch(err => {\n        console.error('获取捐赠详情失败', err);\n        this.$message.error('获取捐赠详情失败');\n      }).finally(() => {\n        this.loading = false;\n      });\n    },\n    getStatusTag(status) {\n      const statusMap = {\n        0: { type: 'info', text: '待审核' },\n        1: { type: 'success', text: '已接受' },\n        2: { type: 'danger', text: '已拒绝' },\n        3: { type: 'primary', text: '已完成' }\n      };\n      return statusMap[status] || { type: 'info', text: '未知状态' };\n    },\n    cancelDonation() {\n      this.$confirm('确定要取消此捐赠请求吗?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$api.cancelDonationRequest(this.donationRequest.id).then(res => {\n          if (res.status_code === 1) {\n            this.$message.success('捐赠请求已取消');\n            this.loadDonationDetail();\n          } else {\n            this.$message.error(res.msg || '操作失败');\n          }\n        }).catch(err => {\n          console.error('取消捐赠请求失败', err);\n          this.$message.error('取消捐赠请求失败');\n        });\n      }).catch(() => {\n        // 取消操作\n      });\n    },\n    goBack() {\n      this.$router.push('/donation/my-requests');\n    },\n    getImageUrl(url) {\n      // 检查url是否已经是HTTP URL\n      if (url && (url.startsWith('http://') || url.startsWith('https://'))) {\n        return url;\n      }\n      \n      // 检查url是否是一个本地文件路径\n      if (url && (url.startsWith('/') || url.startsWith('D:') || url.includes('\\\\') || url.includes('/'))) {\n        // 如果是本地路径，则转换为服务器URL\n        // 这里假设文件名是路径最后的部分\n        const fileName = url.split(/[/\\\\]/).pop();\n        // 构建访问URL\n        return `http://localhost:8082/image?imageName=${fileName}`;\n      }\n      \n      // 如果是简单的文件名，直接构建访问URL\n      if (url && url.trim() !== '') {\n        return `http://localhost:8082/image?imageName=${url}`;\n      }\n      \n      // 其他情况直接返回\n      return url;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.donation-detail-container {\n  padding: 20px;\n  min-height: 80vh;\n}\n\n.detail-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n}\n\n.header-left h2 {\n  margin: 0;\n  margin-right: 15px;\n}\n\n.detail-card {\n  margin-bottom: 20px;\n}\n\n.detail-section {\n  margin-bottom: 20px;\n}\n\n.detail-section h3 {\n  margin-top: 0;\n  margin-bottom: 15px;\n  font-size: 18px;\n  color: #303133;\n}\n\n.detail-item {\n  margin-bottom: 10px;\n}\n\n.label {\n  font-weight: bold;\n  color: #606266;\n  margin-right: 10px;\n}\n\n.item-detail {\n  display: flex;\n}\n\n.item-image {\n  width: 200px;\n  height: 200px;\n  margin-right: 20px;\n}\n\n.item-image img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: 4px;\n}\n\n.item-info {\n  flex: 1;\n}\n\n.item-info h4 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 16px;\n}\n\n.item-price {\n  color: #F56C6C;\n  font-size: 16px;\n  font-weight: bold;\n  margin-bottom: 10px;\n}\n\n.item-description {\n  color: #606266;\n  line-height: 1.5;\n}\n\n.reason-content,\n.feedback-content {\n  background-color: #F5F7FA;\n  padding: 15px;\n  border-radius: 4px;\n  color: #606266;\n  line-height: 1.5;\n}\n\n.process-info {\n  background-color: #F0F9EB;\n  padding: 15px;\n  border-radius: 4px;\n  color: #606266;\n}\n\n.process-info i {\n  color: #67C23A;\n  margin-right: 5px;\n}\n\n.process-info ol {\n  margin-top: 10px;\n  margin-bottom: 0;\n  padding-left: 20px;\n}\n\n.process-info li {\n  margin-bottom: 5px;\n}\n\n.detail-actions {\n  margin-top: 20px;\n  text-align: right;\n}\n\n.empty-detail {\n  text-align: center;\n  padding: 50px 0;\n  color: #909399;\n}\n\n.empty-detail i {\n  font-size: 48px;\n  margin-bottom: 20px;\n}\n\n.empty-detail p {\n  margin-bottom: 20px;\n}\n</style> "]}]}