{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/page/idle-details.vue?vue&type=template&id=4f7ae469&scoped=true","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/page/idle-details.vue","mtime":1742023978617},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js","mtime":1741743640250},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1741743643790},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["\n<div>\n    <app-head></app-head>\n    <app-body>\n        <div class=\"idle-details-container\">\n            <div class=\"details-header\">\n                <div class=\"details-header-user-info\">\n                    <el-image\n                            style=\"width: 80px; height: 80px;border-radius: 5px;\"\n                            :src=\"idleItemInfo.user.avatar\"\n                            fit=\"contain\"></el-image>\n                    <div style=\"margin-left: 10px;\">\n                        <div class=\"details-header-user-info-nickname\">{{idleItemInfo.user.nickname}}</div>\n                        <div class=\"details-header-user-info-time\">{{idleItemInfo.user.signInTime.substring(0,10)}} 加入平台</div>\n                    </div>\n                </div>\n                <div class=\"details-header-buy\">\n                    <div v-show=\"idleItemInfo.idlePrice !== 0\" style=\"color: red;font-size: 18px;font-weight: 600; margin-right: 10px;\">￥{{idleItemInfo.idlePrice}}</div>\n                    <div v-if=\"!isMaster&&idleItemInfo.idleStatus!==1\" style=\"color: red;font-size: 16px;\">闲置已下架或删除</div>\n                    <el-button v-show=\"idleItemInfo.idlePrice > 0\" v-if=\"!isMaster&&idleItemInfo.idleStatus===1\" type=\"danger\" plain @click=\"buyButton(idleItemInfo)\">立即购买</el-button>\n                    <el-button v-show=\"idleItemInfo.idlePrice > 0\" v-if=\"!isMaster&&idleItemInfo.idleStatus===1\" type=\"primary\" plain @click=\"favoriteButton(idleItemInfo)\">{{isFavorite?'取消收藏':'加入收藏'}}</el-button>\n                    <el-button v-if=\"!isMaster&&idleItemInfo.idleStatus===1\" type=\"warning\" plain @click=\"exchangeButton(idleItemInfo)\">发起易物交换</el-button>\n                    <el-button v-if=\"!isMaster\" type=\"info\" plain @click=\"reportButton(idleItemInfo)\">举报</el-button>\n                    <el-button\n                        v-show='idleItemInfo.idlePrice >= 0'\n                        v-if=\"isMaster&&idleItemInfo.idleStatus===1\"\n                        type='primary'\n                        plain\n                        @click=\"isEditing ? saveChanges(idleItemInfo) : editButton()\">{{ buttonText }}</el-button>\n                    <el-button v-if=\"isMaster&&idleItemInfo.idleStatus===1\" type=\"danger\" @click=\"changeStatus(idleItemInfo,2)\" plain>下架</el-button>\n                    <el-button v-if=\"isMaster&&idleItemInfo.idleStatus===2\" type=\"primary\" @click=\"changeStatus(idleItemInfo,1)\" plain>重新上架</el-button>\n                    <el-button v-if=\"isMaster&&idleItemInfo.idleStatus===1\" type=\"info\" plain @click=\"viewReceivedRequests\">查看交换请求</el-button>\n                    <el-button v-if=\"isMaster&&idleItemInfo.idleStatus===1\" type=\"success\" plain @click=\"donationButton(idleItemInfo)\">爱心捐赠</el-button>\n                </div>\n            </div>\n\n\n            <div class=\"details-info\">\n\n                <div v-if=\"isEditing\">\n                    <label class=\"input-label\">价格</label>\n                    <el-input v-model=\"idleItemInfo.idlePrice\" placeholder=\"请输入商品价格\"></el-input>\n                </div>\n                <div class=\"details-info-title\" v-if=\"isEditing\">\n                    <label class=\"input-label\">名称</label>\n                    <el-input v-model=\"idleItemInfo.idleName\" placeholder=\"请输入商品名称\"></el-input>\n                </div>\n                <div class=\"details-info-title\" v-else>\n                    {{idleItemInfo.idleName}}\n                </div>\n                <div v-if=\"isEditing\">\n                    <label class=\"input-label\">详情</label>\n                    <el-input type=\"textarea\" autosize placeholder=\"请输入商品详情...\" v-model=\"idleItemInfo.idleDetails\"></el-input>\n                </div>\n                <div class=\"details-info-main\" v-else v-html=\"idleItemInfo.idleDetails\"></div>\n                <div class=\"details-picture\">\n                    <template v-if=\"isEditing\">\n                        <!-- 编辑模式下的上传控件 -->\n                        <el-upload\n                            :on-remove=\"fileHandleRemove\"\n                            :on-success=\"fileHandleSuccess\"\n                            :on-change=\"imgChange\"\n                            action=\"http://localhost:8082/file\"\n                            list-type=\"picture-card\"\n                            :file-list=\"fileList\"\n                            :before-upload=\"beforeUpload\"\n                        >\n                            <i class=\"el-icon-plus\"></i>\n                        </el-upload>\n                    </template>\n                    <template v-else>\n                        <!-- 显示模式下的图片列表 -->\n                        <div v-loading=\"imageLoading\" class=\"image-container\">\n                            <el-image\n                                v-for=\"(imgUrl, i) in processedPictureList\"\n                                :key=\"i\"\n                                style=\"width: 90%; margin-bottom: 2px;\"\n                                :src=\"getImageUrl(imgUrl)\"\n                                fit=\"contain\"\n                                @load=\"handleImageLoad\"\n                                @error=\"handleImageError\"\n                            >\n                                <div slot=\"error\" class=\"image-slot\">\n                                    <i class=\"el-icon-picture-outline\"></i>\n                                    <p>图片加载失败</p>\n                                </div>\n                            </el-image>\n                        </div>\n                        <div v-if=\"!processedPictureList.length\" class=\"no-image\">\n                            <i class=\"el-icon-picture-outline\"></i>\n                            <p>暂无图片</p>\n                        </div>\n                    </template>\n                </div>\n            </div>\n\n            <div class=\"message-container\" id=\"replyMessageLocation\">\n                <div class=\"message-title\">全部留言</div>\n                <div class=\"message-send\">\n                    <div v-if=\"isReply\" style=\"padding-bottom: 10px;\">\n                        <el-button type=\"info\" @click=\"cancelReply\">回复：{{replyData.toMessage}} @{{replyData.toUserNickname}} <i class=\"el-icon-close el-icon--right\"></i></el-button>\n                    </div>\n                    <el-input\n                            type=\"textarea\"\n                            autosize\n                            placeholder=\"留言提问...\"\n                            v-model=\"messageContent\"\n                            maxlength=\"200\"\n                            show-word-limit>\n                    </el-input>\n                    <div class=\"message-send-button\">\n                        <el-button plain @click=\"sendMessage\">发送留言</el-button>\n                    </div>\n                </div>\n                <div>\n                    <div v-for=\"(mes,index) in messageList\" class=\"message-container-list\">\n                        <div class=\"message-container-list-left\">\n                            <el-image\n                                    style=\"width: 55px; height: 55px;border-radius: 5px;\"\n                                    :src=\"mes.fromU.avatar\"\n                                    fit=\"contain\"></el-image>\n                            <div class=\"message-container-list-text\">\n                                <div class=\"message-nickname\">{{mes.fromU.nickname}}\n                                    {{mes.toU.nickname?' @'+mes.toU.nickname+'：'+\n                                    mes.toM.content.substring(0,10)+\n                                    (mes.toM.content.length>10?'...':''):''}}</div>\n                                <div class=\"message-content\" v-html=\"mes.content\"></div>\n                                <div class=\"message-time\">{{mes.createTime}}</div>\n                            </div>\n                        </div>\n                        <div class=\"message-container-list-right\">\n                            <el-button style=\"float: right;\"  plain @click=\"replyMessage(index)\">回复</el-button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <app-foot></app-foot>\n\n        <!-- 添加易物交换弹窗 -->\n        <el-dialog\n            title=\"发起易物交换\"\n            :visible.sync=\"exchangeDialogVisible\"\n            width=\"60%\">\n            <el-form :model=\"exchangeForm\" :rules=\"exchangeRules\" ref=\"exchangeForm\" label-width=\"120px\">\n                <el-form-item label=\"交换对象物品\" prop=\"requestItemId\">\n                    <div class=\"exchange-preview-item\">\n                        <div v-if=\"idleItemInfo\">\n                            <div class=\"item-preview\">\n                                <img :src=\"getImageUrl(processedPictureList[0])\" class=\"preview-img\">\n                                <div class=\"item-info\">\n                                    <div class=\"item-name\">{{ idleItemInfo.idleName }}</div>\n                                    <div class=\"item-price\">¥{{ idleItemInfo.idlePrice }}</div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </el-form-item>\n                \n                <el-form-item label=\"物品所有者\">\n                    <div class=\"owner-info\" v-if=\"idleItemInfo && idleItemInfo.user\">\n                        <img :src=\"idleItemInfo.user.avatar\" class=\"owner-avatar\">\n                        <span class=\"owner-name\">{{ idleItemInfo.user.nickname }}</span>\n                    </div>\n                </el-form-item>\n                \n                <el-form-item label=\"我的交换物品\" prop=\"offerItemId\">\n                    <el-select v-model=\"exchangeForm.offerItemId\" placeholder=\"选择您提供交换的物品\">\n                        <el-option\n                            v-for=\"item in myItems\"\n                            :key=\"item.id\"\n                            :label=\"item.idleName\"\n                            :value=\"item.id\">\n                            <div class=\"item-option\">\n                                <img :src=\"getFirstImage(item.pictureList)\" class=\"item-img\">\n                                <div class=\"item-info\">\n                                    <div class=\"item-name\">{{ item.idleName }}</div>\n                                    <div class=\"item-price\">¥{{ item.idlePrice }}</div>\n                                </div>\n                            </div>\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                \n                <el-form-item label=\"交换理由\" prop=\"exchangeReason\">\n                    <el-input\n                        type=\"textarea\"\n                        :rows=\"4\"\n                        placeholder=\"请输入交换理由，向对方说明为什么想要交换这个物品\"\n                        v-model=\"exchangeForm.exchangeReason\">\n                    </el-input>\n                </el-form-item>\n            </el-form>\n            \n            <div class=\"exchange-preview\" v-if=\"exchangeForm.offerItemId\">\n                <h4>交换预览</h4>\n                <el-divider></el-divider>\n                <div class=\"exchange-preview-content\">\n                    <div class=\"preview-item\">\n                        <h4>我将获得</h4>\n                        <div class=\"item-card\" v-if=\"idleItemInfo\">\n                            <img :src=\"getImageUrl(processedPictureList[0])\" class=\"preview-img\">\n                            <div class=\"preview-info\">\n                                <div class=\"preview-name\">{{ idleItemInfo.idleName }}</div>\n                                <div class=\"preview-price\">¥{{ idleItemInfo.idlePrice }}</div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"exchange-arrow\">\n                        <i class=\"el-icon-right\"></i>\n                    </div>\n                    <div class=\"preview-item\">\n                        <h4>我将付出</h4>\n                        <div class=\"item-card\" v-if=\"selectedMyItem\">\n                            <img :src=\"getFirstImage(selectedMyItem.pictureList)\" class=\"preview-img\">\n                            <div class=\"preview-info\">\n                                <div class=\"preview-name\">{{ selectedMyItem.idleName }}</div>\n                                <div class=\"preview-price\">¥{{ selectedMyItem.idlePrice }}</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"exchangeDialogVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"submitExchangeRequest\" :loading=\"submitLoading\">提交交换请求</el-button>\n            </span>\n        </el-dialog>\n        \n        <!-- 添加查看交换请求弹窗 -->\n        <el-dialog\n            title=\"交换请求管理\"\n            :visible.sync=\"exchangeRequestsDialogVisible\"\n            width=\"70%\">\n            <el-tabs v-model=\"activeRequestTab\">\n                <el-tab-pane label=\"收到的请求\" name=\"received\">\n                    <div v-loading=\"requestsLoading\">\n                        <div v-if=\"receivedRequests.length === 0\" class=\"empty-requests\">\n                            <i class=\"el-icon-info\"></i>\n                            <p>暂无收到的交换请求</p>\n                        </div>\n                        <el-card v-for=\"request in receivedRequests\" :key=\"request.id\" class=\"request-card\">\n                            <div class=\"request-header\">\n                                <div class=\"request-user\">\n                                    <img :src=\"request.requestUser.avatar\" class=\"user-avatar\">\n                                    <span>{{ request.requestUser.nickname }}</span>\n                                </div>\n                                <div class=\"request-time\">{{ request.createTime }}</div>\n                            </div>\n                            <div class=\"request-content\">\n                                <div class=\"exchange-items\">\n                                    <div class=\"item-card\">\n                                        <div class=\"item-title\">对方想要的物品</div>\n                                        <img :src=\"getFirstImage(request.requestItem.pictureList)\" class=\"item-img\">\n                                        <div class=\"item-info\">\n                                            <div class=\"item-name\">{{ request.requestItem.idleName }}</div>\n                                            <div class=\"item-price\">¥{{ request.requestItem.idlePrice }}</div>\n                                        </div>\n                                    </div>\n                                    <div class=\"exchange-arrow\">\n                                        <i class=\"el-icon-right\"></i>\n                                    </div>\n                                    <div class=\"item-card\">\n                                        <div class=\"item-title\">对方提供的物品</div>\n                                        <img :src=\"getFirstImage(request.offerItem.pictureList)\" class=\"item-img\">\n                                        <div class=\"item-info\">\n                                            <div class=\"item-name\">{{ request.offerItem.idleName }}</div>\n                                            <div class=\"item-price\">¥{{ request.offerItem.idlePrice }}</div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class=\"request-reason\">\n                                    <div class=\"reason-title\">交换理由:</div>\n                                    <div class=\"reason-content\">{{ request.exchangeReason }}</div>\n                                </div>\n                            </div>\n                            <div class=\"request-actions\">\n                                <el-tag :type=\"getStatusTag(request.status).type\">{{ getStatusTag(request.status).text }}</el-tag>\n                                <div class=\"action-buttons\" v-if=\"request.status === 0\">\n                                    <el-button type=\"success\" size=\"small\" @click=\"acceptRequest(request.id)\">接受</el-button>\n                                    <el-button type=\"danger\" size=\"small\" @click=\"rejectRequest(request.id)\">拒绝</el-button>\n                                </div>\n                                <div class=\"action-buttons\" v-if=\"request.status === 1\">\n                                    <el-button type=\"primary\" size=\"small\" @click=\"completeExchange(request.id)\">完成交换</el-button>\n                                </div>\n                            </div>\n                        </el-card>\n                    </div>\n                </el-tab-pane>\n                <el-tab-pane label=\"我发送的请求\" name=\"sent\">\n                    <div v-loading=\"requestsLoading\">\n                        <div v-if=\"sentRequests.length === 0\" class=\"empty-requests\">\n                            <i class=\"el-icon-info\"></i>\n                            <p>暂无发送的交换请求</p>\n                        </div>\n                        <el-card v-for=\"request in sentRequests\" :key=\"request.id\" class=\"request-card\">\n                            <div class=\"request-header\">\n                                <div class=\"request-user\">\n                                    <img :src=\"request.itemOwner.avatar\" class=\"user-avatar\">\n                                    <span>发送给: {{ request.itemOwner.nickname }}</span>\n                                </div>\n                                <div class=\"request-time\">{{ request.createTime }}</div>\n                            </div>\n                            <div class=\"request-content\">\n                                <div class=\"exchange-items\">\n                                    <div class=\"item-card\">\n                                        <div class=\"item-title\">我想要的物品</div>\n                                        <img :src=\"getFirstImage(request.requestItem.pictureList)\" class=\"item-img\">\n                                        <div class=\"item-info\">\n                                            <div class=\"item-name\">{{ request.requestItem.idleName }}</div>\n                                            <div class=\"item-price\">¥{{ request.requestItem.idlePrice }}</div>\n                                        </div>\n                                    </div>\n                                    <div class=\"exchange-arrow\">\n                                        <i class=\"el-icon-right\"></i>\n                                    </div>\n                                    <div class=\"item-card\">\n                                        <div class=\"item-title\">我提供的物品</div>\n                                        <img :src=\"getFirstImage(request.offerItem.pictureList)\" class=\"item-img\">\n                                        <div class=\"item-info\">\n                                            <div class=\"item-name\">{{ request.offerItem.idleName }}</div>\n                                            <div class=\"item-price\">¥{{ request.offerItem.idlePrice }}</div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class=\"request-reason\">\n                                    <div class=\"reason-title\">交换理由:</div>\n                                    <div class=\"reason-content\">{{ request.exchangeReason }}</div>\n                                </div>\n                            </div>\n                            <div class=\"request-actions\">\n                                <el-tag :type=\"getStatusTag(request.status).type\">{{ getStatusTag(request.status).text }}</el-tag>\n                            </div>\n                        </el-card>\n                    </div>\n                </el-tab-pane>\n            </el-tabs>\n        </el-dialog>\n\n        <!-- 添加捐赠弹窗 -->\n        <el-dialog\n            title=\"爱心捐赠\"\n            :visible.sync=\"donationDialogVisible\"\n            width=\"50%\">\n            <el-form :model=\"donationForm\" :rules=\"donationRules\" ref=\"donationForm\" label-width=\"120px\">\n                <el-form-item label=\"捐赠物品\" prop=\"itemId\">\n                    <div class=\"donation-preview-item\">\n                        <div v-if=\"idleItemInfo\">\n                            <div class=\"item-preview\">\n                                <img :src=\"getImageUrl(processedPictureList[0])\" class=\"preview-img\">\n                                <div class=\"item-info\">\n                                    <div class=\"item-name\">{{ idleItemInfo.idleName }}</div>\n                                    <div class=\"item-price\">¥{{ idleItemInfo.idlePrice }}</div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </el-form-item>\n                \n                <el-form-item label=\"捐赠类型\" prop=\"donationType\">\n                    <el-radio-group v-model=\"donationForm.donationType\">\n                        <el-radio :label=\"0\">公益捐赠</el-radio>\n                        <el-radio :label=\"1\">环保回收</el-radio>\n                    </el-radio-group>\n                </el-form-item>\n                \n                <el-form-item label=\"捐赠理由\" prop=\"donationReason\">\n                    <el-input\n                        type=\"textarea\"\n                        :rows=\"4\"\n                        placeholder=\"请输入捐赠理由，说明为什么想要捐赠这个物品\"\n                        v-model=\"donationForm.donationReason\">\n                    </el-input>\n                </el-form-item>\n            </el-form>\n            \n            <div class=\"donation-notes\">\n                <p><i class=\"el-icon-info\"></i> 捐赠说明：</p>\n                <p>1. 公益捐赠：您的物品将捐赠给有需要的人或公益组织</p>\n                <p>2. 环保回收：闲置物品将被环保回收，减少资源浪费</p>\n                <p>3. 捐赠成功后，物品将自动下架</p>\n                <p>4. 捐赠后可能有工作人员与您联系，请保持联系方式畅通</p>\n            </div>\n            \n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"donationDialogVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"submitDonationRequest\" :loading=\"submitLoading\">提交捐赠</el-button>\n            </span>\n        </el-dialog>\n\n        <!-- 添加举报弹窗 -->\n        <el-dialog\n            title=\"举报\"\n            :visible.sync=\"reportDialogVisible\"\n            width=\"50%\">\n            <report-form \n                :reported-user-id=\"idleItemInfo.userId\"\n                :reported-item-id=\"idleItemInfo.id\"\n                @report-submitted=\"reportDialogVisible = false\"\n                @cancel=\"reportDialogVisible = false\">\n            </report-form>\n        </el-dialog>\n    </app-body>\n</div>\n",null]}