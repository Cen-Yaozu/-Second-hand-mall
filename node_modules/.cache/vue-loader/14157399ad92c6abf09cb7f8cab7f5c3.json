{"remainingRequest":"D:\\Desktop\\-Second-hand-mall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\-Second-hand-mall\\src\\components\\common\\AppHeader.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Desktop\\-Second-hand-mall\\src\\components\\common\\AppHeader.vue","mtime":1741232770338},{"path":"D:\\Desktop\\-Second-hand-mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741229036518},{"path":"D:\\Desktop\\-Second-hand-mall\\node_modules\\babel-loader\\lib\\index.js","mtime":1741229036772},{"path":"D:\\Desktop\\-Second-hand-mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741229036518},{"path":"D:\\Desktop\\-Second-hand-mall\\node_modules\\vue-loader\\lib\\index.js","mtime":1741229036465}],"contextDependencies":[],"result":["\r\n    import Mixin from '@/utils/mixin';\r\n    export default {\r\n        mixins: [Mixin],\r\n        name: 'Header',\r\n        props: ['searchInput','nicknameValue','avatarValue'],\r\n        data() {\r\n            return {\r\n                logoPath: \"/logo.png\",\r\n                searchValue: this.searchInput,\r\n                nickname:'登录',\r\n                avatar:'https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png',\r\n                isLogin:false,\r\n                unreadMessagesCount:0\r\n            };\r\n        },\r\n        created(){\r\n            // console.log(\"header\");\r\n            if(! this.$globalData.userInfo.nickname){\r\n                this.$api.getUserInfo().then(res=>{\r\n                    console.log('Header getUserInfo:',res);\r\n                    if(res.status_code===1){\r\n                        this.nickname=res.data.nickname;\r\n                        this.avatar=res.data.avatar;\r\n                        res.data.signInTime=res.data.signInTime.substring(0,10);\r\n                        this.$globalData.userInfo=res.data;\r\n                        this.isLogin=true;\r\n                    }\r\n                })\r\n            }else {\r\n                this.nickname=this.$globalData.userInfo.nickname;\r\n                this.avatar=this.$globalData.userInfo.avatar;\r\n                this.isLogin=true;\r\n            }\r\n            // 获取未读消息数（示例）\r\n            // 您可以添加实际的API调用来获取未读消息数\r\n            this.getUnreadCount();\r\n        },\r\n        methods: {\r\n            searchIdle() {\r\n                if ('/search' !== this.$route.path) {\r\n                    this.$router.push({path: '/search', query: {searchValue: this.searchValue}});\r\n                } else {\r\n                    this.$router.replace({path: '/search', query: {searchValue: this.searchValue}});\r\n                    this.$router.go(0);\r\n                }\r\n            },\r\n            toMe() {\r\n                if ('/me' !== this.$route.path) {\r\n                    this.$router.push({path: '/me'});\r\n                }\r\n            },\r\n            toMessage(){\r\n                if ('/message' !== this.$route.path) {\r\n                    this.$router.push({path: '/message'});\r\n                }\r\n            },\r\n            toRelease(){\r\n                if ('/release' !== this.$route.path) {\r\n                    this.$router.push({path: '/release'});\r\n                }\r\n            },\r\n            /*这里的logout 只是用前端来删除掉浏览器中之前登录过的用户信息，并没有发送请求*/\r\n            loginOut(){\r\n                this.$api.logout().then(res=>{\r\n                    if(res.status_code===1){\r\n                        this.$globalData.userInfo={};\r\n                        console.log(\"login out\");\r\n                        if ('/index' === this.$route.path) {\r\n                            this.$router.go(0);\r\n                        }else {\r\n                            this.$router.push({path: '/index'});\r\n                        }\r\n                    }else {\r\n                        this.$message.error('网络或系统异常，退出登录失败！');\r\n                    }\r\n                });\r\n            },\r\n            // 示例方法：获取未读消息数\r\n            getUnreadCount() {\r\n                // 这里应该是实际的API调用\r\n                // 暂时模拟为随机数（0-5）\r\n                this.unreadMessagesCount = Math.floor(Math.random() * 6);\r\n            }\r\n        }\r\n    };\r\n",{"version":3,"sources":["AppHeader.vue"],"names":[],"mappings":";AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AppHeader.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\r\n    <div class=\"apple-nav\">\r\n        <div class=\"header-container\">\r\n            <div class=\"app-name\">\r\n                <router-link to=\"/\">\r\n                    <img :src=\"logoPath\" class=\"logo\"/>\r\n                </router-link>\r\n            </div>\r\n            <div class=\"search-container\">\r\n                <el-input placeholder=\"搜索闲置物品...\" v-model=\"searchValue\" @keyup.enter.native=\"searchIdle\" class=\"search-input\">\r\n                    <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"searchIdle\"></el-button>\r\n                </el-input>\r\n            </div>\r\n            <div class=\"actions\">\r\n                <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"toRelease\" class=\"action-btn\">发布</el-button>\r\n                <el-button type=\"primary\" plain icon=\"el-icon-chat-dot-round\" @click=\"toMessage\" class=\"action-btn\" :class=\"{'has-badge': unreadMessagesCount > 0}\">\r\n                    <span class=\"badge\" v-if=\"unreadMessagesCount > 0\">{{unreadMessagesCount}}</span>\r\n                    消息\r\n                </el-button>\r\n            </div>\r\n            <div class=\"user-section\">\r\n                <router-link v-if=\"!isLogin\" class=\"login-btn\" to=\"/login\">登录</router-link>\r\n                <el-dropdown trigger=\"click\" v-else>\r\n                    <div class=\"user-profile\">\r\n                        <div class=\"user-name\">{{nickname}}</div>\r\n                        <el-avatar :src=\"avatar\" class=\"user-avatar\"></el-avatar>\r\n                    </div>\r\n                    <el-dropdown-menu slot=\"dropdown\" class=\"user-dropdown\">\r\n                        <el-dropdown-item><div @click=\"toMe\" class=\"dropdown-option\">个人中心</div></el-dropdown-item>\r\n                        <el-dropdown-item divided><div @click=\"loginOut\" class=\"dropdown-option logout\">退出登录</div></el-dropdown-item>\r\n                    </el-dropdown-menu>\r\n                </el-dropdown>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import Mixin from '@/utils/mixin';\r\n    export default {\r\n        mixins: [Mixin],\r\n        name: 'Header',\r\n        props: ['searchInput','nicknameValue','avatarValue'],\r\n        data() {\r\n            return {\r\n                logoPath: \"/logo.png\",\r\n                searchValue: this.searchInput,\r\n                nickname:'登录',\r\n                avatar:'https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png',\r\n                isLogin:false,\r\n                unreadMessagesCount:0\r\n            };\r\n        },\r\n        created(){\r\n            // console.log(\"header\");\r\n            if(! this.$globalData.userInfo.nickname){\r\n                this.$api.getUserInfo().then(res=>{\r\n                    console.log('Header getUserInfo:',res);\r\n                    if(res.status_code===1){\r\n                        this.nickname=res.data.nickname;\r\n                        this.avatar=res.data.avatar;\r\n                        res.data.signInTime=res.data.signInTime.substring(0,10);\r\n                        this.$globalData.userInfo=res.data;\r\n                        this.isLogin=true;\r\n                    }\r\n                })\r\n            }else {\r\n                this.nickname=this.$globalData.userInfo.nickname;\r\n                this.avatar=this.$globalData.userInfo.avatar;\r\n                this.isLogin=true;\r\n            }\r\n            // 获取未读消息数（示例）\r\n            // 您可以添加实际的API调用来获取未读消息数\r\n            this.getUnreadCount();\r\n        },\r\n        methods: {\r\n            searchIdle() {\r\n                if ('/search' !== this.$route.path) {\r\n                    this.$router.push({path: '/search', query: {searchValue: this.searchValue}});\r\n                } else {\r\n                    this.$router.replace({path: '/search', query: {searchValue: this.searchValue}});\r\n                    this.$router.go(0);\r\n                }\r\n            },\r\n            toMe() {\r\n                if ('/me' !== this.$route.path) {\r\n                    this.$router.push({path: '/me'});\r\n                }\r\n            },\r\n            toMessage(){\r\n                if ('/message' !== this.$route.path) {\r\n                    this.$router.push({path: '/message'});\r\n                }\r\n            },\r\n            toRelease(){\r\n                if ('/release' !== this.$route.path) {\r\n                    this.$router.push({path: '/release'});\r\n                }\r\n            },\r\n            /*这里的logout 只是用前端来删除掉浏览器中之前登录过的用户信息，并没有发送请求*/\r\n            loginOut(){\r\n                this.$api.logout().then(res=>{\r\n                    if(res.status_code===1){\r\n                        this.$globalData.userInfo={};\r\n                        console.log(\"login out\");\r\n                        if ('/index' === this.$route.path) {\r\n                            this.$router.go(0);\r\n                        }else {\r\n                            this.$router.push({path: '/index'});\r\n                        }\r\n                    }else {\r\n                        this.$message.error('网络或系统异常，退出登录失败！');\r\n                    }\r\n                });\r\n            },\r\n            // 示例方法：获取未读消息数\r\n            getUnreadCount() {\r\n                // 这里应该是实际的API调用\r\n                // 暂时模拟为随机数（0-5）\r\n                this.unreadMessagesCount = Math.floor(Math.random() * 6);\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n.apple-nav {\r\n    padding: var(--spacing-md) 0;\r\n}\r\n\r\n.header-container {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 0 var(--spacing-lg);\r\n}\r\n\r\n.logo {\r\n    width: 40px;\r\n    height: 40px;\r\n    object-fit: contain;\r\n    transition: transform 0.2s ease;\r\n}\r\n\r\n.logo:hover {\r\n    transform: scale(1.05);\r\n}\r\n\r\n.app-name {\r\n    margin-right: var(--spacing-lg);\r\n}\r\n\r\n.search-container {\r\n    flex: 1;\r\n    max-width: 500px;\r\n    margin: 0 var(--spacing-xl);\r\n}\r\n\r\n.search-input >>> .el-input__inner {\r\n    border-radius: var(--radius-pill);\r\n    height: 44px;\r\n    background-color: var(--apple-bg-secondary);\r\n    border: none;\r\n    padding-left: 20px;\r\n}\r\n\r\n.search-input >>> .el-input-group__append {\r\n    border-radius: 0 var(--radius-pill) var(--radius-pill) 0;\r\n    background-color: var(--apple-bg-secondary);\r\n    border: none;\r\n    padding: 0 15px;\r\n}\r\n\r\n.actions {\r\n    display: flex;\r\n    margin-right: var(--spacing-xl);\r\n}\r\n\r\n.action-btn {\r\n    margin-left: var(--spacing-md);\r\n    position: relative;\r\n}\r\n\r\n.action-btn.has-badge {\r\n    padding-right: 32px;\r\n}\r\n\r\n.badge {\r\n    position: absolute;\r\n    top: -6px;\r\n    right: -6px;\r\n    background-color: var(--apple-error);\r\n    color: white;\r\n    border-radius: 50%;\r\n    min-width: 20px;\r\n    height: 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    font-size: 12px;\r\n    font-weight: bold;\r\n}\r\n\r\n.user-section {\r\n    margin-left: auto;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.login-btn {\r\n    color: var(--apple-accent);\r\n    font-weight: 500;\r\n    font-size: 16px;\r\n    padding: var(--spacing-sm) var(--spacing-md);\r\n    border-radius: var(--radius-pill);\r\n    transition: background-color 0.2s ease;\r\n}\r\n\r\n.login-btn:hover {\r\n    background-color: var(--apple-bg-secondary);\r\n}\r\n\r\n.user-profile {\r\n    display: flex;\r\n    align-items: center;\r\n    cursor: pointer;\r\n    padding: var(--spacing-xs);\r\n    border-radius: var(--radius-pill);\r\n    transition: background-color 0.2s ease;\r\n}\r\n\r\n.user-profile:hover {\r\n    background-color: var(--apple-bg-secondary);\r\n}\r\n\r\n.user-name {\r\n    margin-right: var(--spacing-md);\r\n    font-weight: 500;\r\n    color: var(--apple-accent);\r\n}\r\n\r\n.user-avatar {\r\n    width: 36px;\r\n    height: 36px;\r\n    border-radius: 50%;\r\n    box-shadow: var(--shadow-sm);\r\n}\r\n\r\n.user-dropdown {\r\n    min-width: 140px;\r\n    margin-top: var(--spacing-sm);\r\n}\r\n\r\n.dropdown-option {\r\n    padding: var(--spacing-xs) 0;\r\n    width: 100%;\r\n    text-align: center;\r\n    font-weight: 500;\r\n}\r\n\r\n.logout {\r\n    color: var(--apple-error);\r\n}\r\n</style>\r\n"]}]}