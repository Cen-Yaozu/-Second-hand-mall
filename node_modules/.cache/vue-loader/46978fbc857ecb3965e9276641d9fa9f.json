{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/admin/announcement/AdminAnnouncementList.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/admin/announcement/AdminAnnouncementList.vue","mtime":1742200278841},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js","mtime":1741743640250},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["\nexport default {\n  name: 'AdminAnnouncementList',\n  data() {\n    return {\n      loading: false,\n      announcementList: [],\n      total: 0,\n      queryParams: {\n        page: 1,\n        size: 10,\n        type: null,\n        status: null,\n        isImportant: null\n      }\n    };\n  },\n  created() {\n    this.fetchAnnouncementList();\n  },\n  methods: {\n    fetchAnnouncementList() {\n      this.loading = true;\n      // 构建请求参数，移除值为null的参数\n      const params = {};\n      Object.keys(this.queryParams).forEach(key => {\n        if (this.queryParams[key] !== null) {\n          params[key] = this.queryParams[key];\n        }\n      });\n      \n      this.$api.adminGetAnnouncementList(params).then(res => {\n        this.loading = false;\n        if (res.status_code === 1) {\n          this.announcementList = res.data || [];\n          this.total = res.total || this.announcementList.length;\n        } else {\n          this.$message.error('获取公告列表失败');\n        }\n      }).catch(() => {\n        this.loading = false;\n        this.$message.error('获取公告列表失败');\n      });\n    },\n    createAnnouncement() {\n      this.$router.push('/admin/announcement/create');\n    },\n    viewAnnouncement(row) {\n      this.$router.push(`/admin/announcement/detail/${row.id}`);\n    },\n    editAnnouncement(row) {\n      this.$router.push(`/admin/announcement/edit/${row.id}`);\n    },\n    publishAnnouncement(row) {\n      this.$confirm('确认发布此公告?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$api.adminPublishAnnouncement(row.id).then(res => {\n          if (res.status_code === 1) {\n            this.$message.success('公告发布成功');\n            this.fetchAnnouncementList();\n          } else {\n            this.$message.error('公告发布失败');\n          }\n        }).catch(() => {\n          this.$message.error('公告发布失败');\n        });\n      }).catch(() => {});\n    },\n    deleteAnnouncement(row) {\n      this.$confirm('确认删除此公告? 删除后无法恢复!', '警告', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'error'\n      }).then(() => {\n        this.$api.adminDeleteAnnouncement(row.id).then(res => {\n          if (res.status_code === 1) {\n            this.$message.success('公告删除成功');\n            this.fetchAnnouncementList();\n          } else {\n            this.$message.error('公告删除失败');\n          }\n        }).catch(() => {\n          this.$message.error('公告删除失败');\n        });\n      }).catch(() => {});\n    },\n    handleSearch() {\n      this.queryParams.page = 1;\n      this.fetchAnnouncementList();\n    },\n    resetQuery() {\n      this.queryParams = {\n        page: 1,\n        size: 10,\n        type: null,\n        status: null,\n        isImportant: null\n      };\n      this.fetchAnnouncementList();\n    },\n    handleCurrentChange(page) {\n      this.queryParams.page = page;\n      this.fetchAnnouncementList();\n    },\n    getTypeName(type) {\n      switch (type) {\n        case 1: return '系统更新';\n        case 2: return '活动通知';\n        case 3: return '规则变更';\n        default: return '未知类型';\n      }\n    },\n    getTypeTag(type) {\n      switch (type) {\n        case 1: return 'primary';\n        case 2: return 'success';\n        case 3: return 'warning';\n        default: return 'info';\n      }\n    },\n    getStatusName(status) {\n      switch (status) {\n        case 0: return '草稿';\n        case 1: return '已发布';\n        case 2: return '已过期';\n        default: return '未知';\n      }\n    },\n    getStatusTag(status) {\n      switch (status) {\n        case 0: return 'info';\n        case 1: return 'success';\n        case 2: return 'danger';\n        default: return '';\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n    }\n  }\n};\n",{"version":3,"sources":["AdminAnnouncementList.vue"],"names":[],"mappings":";AAuHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminAnnouncementList.vue","sourceRoot":"src/components/admin/announcement","sourcesContent":["<template>\n  <div class=\"admin-announcement-list\">\n    <div class=\"admin-announcement-header\">\n      <div class=\"header-title\">公告管理</div>\n      <div class=\"header-actions\">\n        <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"createAnnouncement\">新建公告</el-button>\n      </div>\n    </div>\n\n    <div class=\"filter-container\">\n      <el-select v-model=\"queryParams.type\" placeholder=\"公告类型\" clearable class=\"filter-item\">\n        <el-option label=\"全部类型\" :value=\"null\"></el-option>\n        <el-option label=\"系统更新\" :value=\"1\"></el-option>\n        <el-option label=\"活动通知\" :value=\"2\"></el-option>\n        <el-option label=\"规则变更\" :value=\"3\"></el-option>\n      </el-select>\n      \n      <el-select v-model=\"queryParams.status\" placeholder=\"公告状态\" clearable class=\"filter-item\">\n        <el-option label=\"全部状态\" :value=\"null\"></el-option>\n        <el-option label=\"草稿\" :value=\"0\"></el-option>\n        <el-option label=\"已发布\" :value=\"1\"></el-option>\n        <el-option label=\"已过期\" :value=\"2\"></el-option>\n      </el-select>\n      \n      <el-select v-model=\"queryParams.isImportant\" placeholder=\"重要程度\" clearable class=\"filter-item\">\n        <el-option label=\"全部\" :value=\"null\"></el-option>\n        <el-option label=\"重要\" :value=\"true\"></el-option>\n        <el-option label=\"普通\" :value=\"false\"></el-option>\n      </el-select>\n      \n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleSearch\">搜索</el-button>\n      <el-button icon=\"el-icon-refresh\" @click=\"resetQuery\">重置</el-button>\n    </div>\n\n    <el-table\n      v-loading=\"loading\"\n      :data=\"announcementList\"\n      style=\"width: 100%\">\n      <el-table-column\n        prop=\"title\"\n        label=\"标题\"\n        min-width=\"200\">\n        <template slot-scope=\"scope\">\n          <div class=\"announcement-title\">\n            <span v-if=\"scope.row.isImportant\" class=\"important-tag\">重要</span>\n            {{ scope.row.title }}\n          </div>\n        </template>\n      </el-table-column>\n      \n      <el-table-column\n        prop=\"type\"\n        label=\"类型\"\n        width=\"120\">\n        <template slot-scope=\"scope\">\n          <el-tag :type=\"getTypeTag(scope.row.type)\">{{ getTypeName(scope.row.type) }}</el-tag>\n        </template>\n      </el-table-column>\n      \n      <el-table-column\n        prop=\"status\"\n        label=\"状态\"\n        width=\"100\">\n        <template slot-scope=\"scope\">\n          <el-tag :type=\"getStatusTag(scope.row.status)\">{{ getStatusName(scope.row.status) }}</el-tag>\n        </template>\n      </el-table-column>\n      \n      <el-table-column\n        prop=\"createTime\"\n        label=\"创建时间\"\n        width=\"160\">\n        <template slot-scope=\"scope\">\n          {{ formatDate(scope.row.createTime) }}\n        </template>\n      </el-table-column>\n      \n      <el-table-column\n        prop=\"publishTime\"\n        label=\"发布时间\"\n        width=\"160\">\n        <template slot-scope=\"scope\">\n          {{ formatDate(scope.row.publishTime) || '未发布' }}\n        </template>\n      </el-table-column>\n      \n      <el-table-column\n        label=\"操作\"\n        width=\"200\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" type=\"text\" @click=\"viewAnnouncement(scope.row)\">查看</el-button>\n          <el-button size=\"mini\" type=\"text\" @click=\"editAnnouncement(scope.row)\">编辑</el-button>\n          <el-button \n            v-if=\"scope.row.status === 0\" \n            size=\"mini\" \n            type=\"text\" \n            @click=\"publishAnnouncement(scope.row)\">发布</el-button>\n          <el-button \n            size=\"mini\" \n            type=\"text\" \n            class=\"danger-btn\" \n            @click=\"deleteAnnouncement(scope.row)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <div class=\"pagination-container\">\n      <el-pagination\n        @current-change=\"handleCurrentChange\"\n        :current-page.sync=\"queryParams.page\"\n        :page-size=\"queryParams.size\"\n        layout=\"total, prev, pager, next\"\n        :total=\"total\">\n      </el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'AdminAnnouncementList',\n  data() {\n    return {\n      loading: false,\n      announcementList: [],\n      total: 0,\n      queryParams: {\n        page: 1,\n        size: 10,\n        type: null,\n        status: null,\n        isImportant: null\n      }\n    };\n  },\n  created() {\n    this.fetchAnnouncementList();\n  },\n  methods: {\n    fetchAnnouncementList() {\n      this.loading = true;\n      // 构建请求参数，移除值为null的参数\n      const params = {};\n      Object.keys(this.queryParams).forEach(key => {\n        if (this.queryParams[key] !== null) {\n          params[key] = this.queryParams[key];\n        }\n      });\n      \n      this.$api.adminGetAnnouncementList(params).then(res => {\n        this.loading = false;\n        if (res.status_code === 1) {\n          this.announcementList = res.data || [];\n          this.total = res.total || this.announcementList.length;\n        } else {\n          this.$message.error('获取公告列表失败');\n        }\n      }).catch(() => {\n        this.loading = false;\n        this.$message.error('获取公告列表失败');\n      });\n    },\n    createAnnouncement() {\n      this.$router.push('/admin/announcement/create');\n    },\n    viewAnnouncement(row) {\n      this.$router.push(`/admin/announcement/detail/${row.id}`);\n    },\n    editAnnouncement(row) {\n      this.$router.push(`/admin/announcement/edit/${row.id}`);\n    },\n    publishAnnouncement(row) {\n      this.$confirm('确认发布此公告?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$api.adminPublishAnnouncement(row.id).then(res => {\n          if (res.status_code === 1) {\n            this.$message.success('公告发布成功');\n            this.fetchAnnouncementList();\n          } else {\n            this.$message.error('公告发布失败');\n          }\n        }).catch(() => {\n          this.$message.error('公告发布失败');\n        });\n      }).catch(() => {});\n    },\n    deleteAnnouncement(row) {\n      this.$confirm('确认删除此公告? 删除后无法恢复!', '警告', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'error'\n      }).then(() => {\n        this.$api.adminDeleteAnnouncement(row.id).then(res => {\n          if (res.status_code === 1) {\n            this.$message.success('公告删除成功');\n            this.fetchAnnouncementList();\n          } else {\n            this.$message.error('公告删除失败');\n          }\n        }).catch(() => {\n          this.$message.error('公告删除失败');\n        });\n      }).catch(() => {});\n    },\n    handleSearch() {\n      this.queryParams.page = 1;\n      this.fetchAnnouncementList();\n    },\n    resetQuery() {\n      this.queryParams = {\n        page: 1,\n        size: 10,\n        type: null,\n        status: null,\n        isImportant: null\n      };\n      this.fetchAnnouncementList();\n    },\n    handleCurrentChange(page) {\n      this.queryParams.page = page;\n      this.fetchAnnouncementList();\n    },\n    getTypeName(type) {\n      switch (type) {\n        case 1: return '系统更新';\n        case 2: return '活动通知';\n        case 3: return '规则变更';\n        default: return '未知类型';\n      }\n    },\n    getTypeTag(type) {\n      switch (type) {\n        case 1: return 'primary';\n        case 2: return 'success';\n        case 3: return 'warning';\n        default: return 'info';\n      }\n    },\n    getStatusName(status) {\n      switch (status) {\n        case 0: return '草稿';\n        case 1: return '已发布';\n        case 2: return '已过期';\n        default: return '未知';\n      }\n    },\n    getStatusTag(status) {\n      switch (status) {\n        case 0: return 'info';\n        case 1: return 'success';\n        case 2: return 'danger';\n        default: return '';\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.admin-announcement-list {\n  padding: 20px;\n}\n\n.admin-announcement-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.header-title {\n  font-size: 20px;\n  font-weight: bold;\n}\n\n.filter-container {\n  margin-bottom: 20px;\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.filter-item {\n  margin-right: 10px;\n  margin-bottom: 10px;\n  width: 150px;\n}\n\n.important-tag {\n  display: inline-block;\n  padding: 2px 5px;\n  background-color: #F56C6C;\n  color: white;\n  border-radius: 3px;\n  font-size: 12px;\n  margin-right: 5px;\n}\n\n.pagination-container {\n  margin-top: 20px;\n  text-align: right;\n}\n\n.danger-btn {\n  color: #F56C6C;\n}\n</style> "]}]}