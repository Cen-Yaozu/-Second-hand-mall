{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/common/ReportForm.vue?vue&type=style&index=0&id=7815c0fc&scoped=true&lang=css","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/common/ReportForm.vue","mtime":1742022321891},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/css-loader/index.js","mtime":1741743640772},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1741743643789},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/postcss-loader/src/index.js","mtime":1741743642507},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["\n.report-form {\n  padding: 20px;\n}\n.form-actions {\n  margin-top: 20px;\n  text-align: right;\n}\n.el-upload__tip {\n  line-height: 1.2;\n  font-size: 12px;\n  color: #606266;\n}\n",{"version":3,"sources":["ReportForm.vue"],"names":[],"mappings":";AA0IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReportForm.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\n  <div class=\"report-form\">\n    <el-form :model=\"reportForm\" :rules=\"rules\" ref=\"reportForm\" label-width=\"100px\">\n      <el-form-item label=\"举报类型\" prop=\"reportType\">\n        <el-radio-group v-model=\"reportForm.reportType\">\n          <el-radio :label=\"1\">虚假信息</el-radio>\n          <el-radio :label=\"2\">违禁物品</el-radio>\n          <el-radio :label=\"3\">欺诈行为</el-radio>\n          <el-radio :label=\"4\">其他</el-radio>\n        </el-radio-group>\n      </el-form-item>\n      \n      <el-form-item label=\"举报理由\" prop=\"reportReason\">\n        <el-input\n          type=\"textarea\"\n          :rows=\"4\"\n          placeholder=\"请详细描述您举报的理由，例如具体的虚假信息、违规内容等\"\n          v-model=\"reportForm.reportReason\">\n        </el-input>\n      </el-form-item>\n      \n      <el-form-item label=\"举证材料\">\n        <el-upload\n          action=\"http://localhost:8082/file\"\n          list-type=\"picture-card\"\n          :on-success=\"handleUploadSuccess\"\n          :on-remove=\"handleUploadRemove\"\n          :before-upload=\"beforeUpload\"\n          multiple>\n          <i class=\"el-icon-plus\"></i>\n          <div slot=\"tip\" class=\"el-upload__tip\">支持上传jpg/png图片，不超过5MB</div>\n        </el-upload>\n      </el-form-item>\n    </el-form>\n    \n    <div class=\"form-actions\">\n      <el-button @click=\"resetForm\">取消</el-button>\n      <el-button type=\"primary\" @click=\"submitReport\" :loading=\"submitting\">提交举报</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ReportForm',\n  props: {\n    reportedUserId: {\n      type: Number,\n      required: true\n    },\n    reportedItemId: {\n      type: Number,\n      default: null\n    }\n  },\n  data() {\n    return {\n      reportForm: {\n        reportType: 1,\n        reportReason: '',\n        evidenceUrls: '',\n        reportedUserId: this.reportedUserId,\n        reportedItemId: this.reportedItemId\n      },\n      evidenceList: [],\n      submitting: false,\n      rules: {\n        reportType: [\n          { required: true, message: '请选择举报类型', trigger: 'change' }\n        ],\n        reportReason: [\n          { required: true, message: '请输入举报理由', trigger: 'blur' },\n          { min: 10, max: 500, message: '举报理由长度应在10到500个字符之间', trigger: 'blur' }\n        ]\n      }\n    };\n  },\n  methods: {\n    handleUploadSuccess(response, file, fileList) {\n      if (response.status_code === 1) {\n        this.evidenceList.push(response.data);\n        this.reportForm.evidenceUrls = this.evidenceList.join(',');\n      } else {\n        this.$message.error('图片上传失败');\n      }\n    },\n    handleUploadRemove(file, fileList) {\n      const index = this.evidenceList.indexOf(file.response.data);\n      if (index !== -1) {\n        this.evidenceList.splice(index, 1);\n        this.reportForm.evidenceUrls = this.evidenceList.join(',');\n      }\n    },\n    beforeUpload(file) {\n      const isJPGOrPNG = file.type === 'image/jpeg' || file.type === 'image/png';\n      const isLt5M = file.size / 1024 / 1024 < 5;\n\n      if (!isJPGOrPNG) {\n        this.$message.error('只能上传JPG或PNG格式的图片!');\n      }\n      if (!isLt5M) {\n        this.$message.error('图片大小不能超过5MB!');\n      }\n      return isJPGOrPNG && isLt5M;\n    },\n    submitReport() {\n      this.$refs.reportForm.validate((valid) => {\n        if (valid) {\n          this.submitting = true;\n          this.$api.createReport(this.reportForm).then(res => {\n            this.submitting = false;\n            if (res.status_code === 1) {\n              this.$message.success('举报提交成功');\n              this.$emit('report-submitted');\n              this.resetForm();\n            } else {\n              this.$message.error(res.msg || '提交失败，请稍后重试');\n            }\n          }).catch(() => {\n            this.submitting = false;\n            this.$message.error('网络错误，请稍后重试');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    resetForm() {\n      this.$refs.reportForm.resetFields();\n      this.evidenceList = [];\n      this.reportForm.evidenceUrls = '';\n      this.$emit('cancel');\n    }\n  }\n};\n</script>\n\n<style scoped>\n.report-form {\n  padding: 20px;\n}\n.form-actions {\n  margin-top: 20px;\n  text-align: right;\n}\n.el-upload__tip {\n  line-height: 1.2;\n  font-size: 12px;\n  color: #606266;\n}\n</style> "]}]}