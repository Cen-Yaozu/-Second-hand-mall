{"remainingRequest":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/-Second-hand-mall/src/components/common/ReportList.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/macos/Desktop/-Second-hand-mall/src/components/common/ReportList.vue","mtime":1742022790218},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/babel-loader/lib/index.js","mtime":1741743640250},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/cache-loader/dist/cjs.js","mtime":1741743640345},{"path":"/Users/macos/Desktop/-Second-hand-mall/node_modules/vue-loader/lib/index.js","mtime":1741743643788}],"contextDependencies":[],"result":["\nexport default {\n  name: \"ReportList\",\n  data() {\n    return {\n      searchValue: \"\",\n      statusFilter: \"\",\n      reportList: [],\n      loading: false,\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      detailDialogVisible: false,\n      handleDialogVisible: false,\n      currentReport: null,\n      dialogTitle: \"\",\n      handleForm: {\n        reportId: null,\n        reason: \"\",\n        action: \"\" // \"approve\" 或 \"reject\"\n      }\n    };\n  },\n  created() {\n    this.fetchReportList();\n  },\n  methods: {\n    fetchReportList() {\n      this.loading = true;\n      const query = {\n        page: this.currentPage,\n        nums: this.pageSize\n      };\n      \n      if (this.searchValue) {\n        query.keyword = this.searchValue;\n      }\n      \n      if (this.statusFilter !== \"\") {\n        query.status = this.statusFilter;\n      }\n      \n      this.$api.getAdminReportList(query)\n        .then(res => {\n          if (res.status_code === 1) {\n            this.reportList = res.data.list;\n            this.total = res.data.total;\n          } else {\n            this.$message.error(res.msg || \"获取举报列表失败\");\n          }\n        })\n        .catch(err => {\n          console.error(err);\n          this.$message.error(\"获取举报列表失败\");\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    },\n    handleSearch() {\n      this.currentPage = 1;\n      this.fetchReportList();\n    },\n    handleSizeChange(val) {\n      this.pageSize = val;\n      this.fetchReportList();\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n      this.fetchReportList();\n    },\n    getStatusType(status) {\n      const types = {\n        0: \"warning\",\n        1: \"success\",\n        2: \"danger\"\n      };\n      return types[status] || \"info\";\n    },\n    getStatusText(status) {\n      const texts = {\n        0: \"待处理\",\n        1: \"已通过\",\n        2: \"已拒绝\"\n      };\n      return texts[status] || \"未知\";\n    },\n    handleDetail(row) {\n      this.currentReport = row;\n      this.detailDialogVisible = true;\n    },\n    handleApprove(row) {\n      this.currentReport = row;\n      this.handleForm.reportId = row.id;\n      this.handleForm.reason = \"\";\n      this.handleForm.action = \"approve\";\n      this.dialogTitle = \"通过举报\";\n      this.handleDialogVisible = true;\n    },\n    handleReject(row) {\n      this.currentReport = row;\n      this.handleForm.reportId = row.id;\n      this.handleForm.reason = \"\";\n      this.handleForm.action = \"reject\";\n      this.dialogTitle = \"拒绝举报\";\n      this.handleDialogVisible = true;\n    },\n    submitHandle() {\n      if (!this.handleForm.reason) {\n        this.$message.warning(\"请输入处理原因\");\n        return;\n      }\n      \n      const data = {\n        reportId: this.handleForm.reportId,\n        handleReason: this.handleForm.reason\n      };\n      \n      this.loading = true;\n      \n      if (this.handleForm.action === \"approve\") {\n        this.$api.adminHandleReport(data)\n          .then(this.handleResponse)\n          .catch(this.handleError)\n          .finally(() => {\n            this.loading = false;\n          });\n      } else {\n        this.$api.adminRejectReport(data)\n          .then(this.handleResponse)\n          .catch(this.handleError)\n          .finally(() => {\n            this.loading = false;\n          });\n      }\n    },\n    handleResponse(res) {\n      if (res.status_code === 1) {\n        this.$message.success(res.msg || \"处理成功\");\n        this.handleDialogVisible = false;\n        this.detailDialogVisible = false;\n        this.fetchReportList();\n      } else {\n        this.$message.error(res.msg || \"处理失败\");\n      }\n    },\n    handleError(err) {\n      console.error(err);\n      this.$message.error(\"处理失败\");\n    },\n    viewItem(itemId) {\n      if (itemId) {\n        window.open(`/details?id=${itemId}`, '_blank');\n      }\n    }\n  }\n};\n",{"version":3,"sources":["ReportList.vue"],"names":[],"mappings":";AAwMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReportList.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\n  <div class=\"report-list-container\">\n    <div class=\"search-bar\">\n      <el-input\n        placeholder=\"搜索举报内容\"\n        v-model=\"searchValue\"\n        class=\"search-input\"\n        clearable\n        @keyup.enter.native=\"handleSearch\"\n      >\n        <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"handleSearch\"></el-button>\n      </el-input>\n      <el-select v-model=\"statusFilter\" placeholder=\"状态筛选\" @change=\"handleSearch\" clearable>\n        <el-option label=\"待处理\" :value=\"0\"></el-option>\n        <el-option label=\"已通过\" :value=\"1\"></el-option>\n        <el-option label=\"已拒绝\" :value=\"2\"></el-option>\n      </el-select>\n    </div>\n\n    <el-table\n      :data=\"reportList\"\n      style=\"width: 100%\"\n      v-loading=\"loading\"\n      border\n    >\n      <el-table-column\n        prop=\"id\"\n        label=\"ID\"\n        width=\"80\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"reporterName\"\n        label=\"举报人\"\n        width=\"120\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"reportedUserName\"\n        label=\"被举报人\"\n        width=\"120\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"reportedItemName\"\n        label=\"被举报商品\"\n        width=\"180\"\n      >\n        <template slot-scope=\"scope\">\n          <el-link type=\"primary\" @click=\"viewItem(scope.row.reportedItemId)\">\n            {{ scope.row.reportedItemName }}\n          </el-link>\n        </template>\n      </el-table-column>\n      <el-table-column\n        prop=\"reportReason\"\n        label=\"举报原因\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"createTime\"\n        label=\"举报时间\"\n        width=\"160\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"status\"\n        label=\"状态\"\n        width=\"100\"\n      >\n        <template slot-scope=\"scope\">\n          <el-tag :type=\"getStatusType(scope.row.status)\">\n            {{ getStatusText(scope.row.status) }}\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column\n        label=\"操作\"\n        width=\"200\"\n      >\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            type=\"primary\"\n            @click=\"handleDetail(scope.row)\"\n            icon=\"el-icon-view\"\n          >查看</el-button>\n          <el-button\n            v-if=\"scope.row.status === 0\"\n            size=\"mini\"\n            type=\"success\"\n            @click=\"handleApprove(scope.row)\"\n            icon=\"el-icon-check\"\n          >通过</el-button>\n          <el-button\n            v-if=\"scope.row.status === 0\"\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleReject(scope.row)\"\n            icon=\"el-icon-close\"\n          >拒绝</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <div class=\"pagination\">\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-sizes=\"[10, 20, 30, 50]\"\n        :page-size=\"pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      ></el-pagination>\n    </div>\n\n    <!-- 举报详情对话框 -->\n    <el-dialog\n      title=\"举报详情\"\n      :visible.sync=\"detailDialogVisible\"\n      width=\"50%\"\n    >\n      <div v-if=\"currentReport\">\n        <div class=\"detail-item\">\n          <span class=\"label\">举报ID：</span>\n          <span>{{ currentReport.id }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">举报人：</span>\n          <span>{{ currentReport.reporterName }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">被举报人：</span>\n          <span>{{ currentReport.reportedUserName }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">被举报商品：</span>\n          <el-link type=\"primary\" @click=\"viewItem(currentReport.reportedItemId)\">\n            {{ currentReport.reportedItemName }}\n          </el-link>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">举报原因：</span>\n          <span>{{ currentReport.reportReason }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">举报时间：</span>\n          <span>{{ currentReport.createTime }}</span>\n        </div>\n        <div class=\"detail-item\">\n          <span class=\"label\">状态：</span>\n          <el-tag :type=\"getStatusType(currentReport.status)\">\n            {{ getStatusText(currentReport.status) }}\n          </el-tag>\n        </div>\n        <div class=\"detail-item\" v-if=\"currentReport.handleTime\">\n          <span class=\"label\">处理时间：</span>\n          <span>{{ currentReport.handleTime }}</span>\n        </div>\n        <div class=\"detail-item\" v-if=\"currentReport.handleReason\">\n          <span class=\"label\">处理结果：</span>\n          <span>{{ currentReport.handleReason }}</span>\n        </div>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"detailDialogVisible = false\">关闭</el-button>\n        <el-button \n          v-if=\"currentReport && currentReport.status === 0\" \n          type=\"success\" \n          @click=\"handleApprove(currentReport)\"\n        >通过举报</el-button>\n        <el-button \n          v-if=\"currentReport && currentReport.status === 0\" \n          type=\"danger\" \n          @click=\"handleReject(currentReport)\"\n        >拒绝举报</el-button>\n      </span>\n    </el-dialog>\n\n    <!-- 处理举报对话框 -->\n    <el-dialog\n      :title=\"dialogTitle\"\n      :visible.sync=\"handleDialogVisible\"\n      width=\"40%\"\n    >\n      <el-form :model=\"handleForm\" label-width=\"100px\">\n        <el-form-item label=\"处理原因：\">\n          <el-input\n            type=\"textarea\"\n            :rows=\"4\"\n            placeholder=\"请输入处理原因\"\n            v-model=\"handleForm.reason\"\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"handleDialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"submitHandle\">确定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"ReportList\",\n  data() {\n    return {\n      searchValue: \"\",\n      statusFilter: \"\",\n      reportList: [],\n      loading: false,\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      detailDialogVisible: false,\n      handleDialogVisible: false,\n      currentReport: null,\n      dialogTitle: \"\",\n      handleForm: {\n        reportId: null,\n        reason: \"\",\n        action: \"\" // \"approve\" 或 \"reject\"\n      }\n    };\n  },\n  created() {\n    this.fetchReportList();\n  },\n  methods: {\n    fetchReportList() {\n      this.loading = true;\n      const query = {\n        page: this.currentPage,\n        nums: this.pageSize\n      };\n      \n      if (this.searchValue) {\n        query.keyword = this.searchValue;\n      }\n      \n      if (this.statusFilter !== \"\") {\n        query.status = this.statusFilter;\n      }\n      \n      this.$api.getAdminReportList(query)\n        .then(res => {\n          if (res.status_code === 1) {\n            this.reportList = res.data.list;\n            this.total = res.data.total;\n          } else {\n            this.$message.error(res.msg || \"获取举报列表失败\");\n          }\n        })\n        .catch(err => {\n          console.error(err);\n          this.$message.error(\"获取举报列表失败\");\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    },\n    handleSearch() {\n      this.currentPage = 1;\n      this.fetchReportList();\n    },\n    handleSizeChange(val) {\n      this.pageSize = val;\n      this.fetchReportList();\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n      this.fetchReportList();\n    },\n    getStatusType(status) {\n      const types = {\n        0: \"warning\",\n        1: \"success\",\n        2: \"danger\"\n      };\n      return types[status] || \"info\";\n    },\n    getStatusText(status) {\n      const texts = {\n        0: \"待处理\",\n        1: \"已通过\",\n        2: \"已拒绝\"\n      };\n      return texts[status] || \"未知\";\n    },\n    handleDetail(row) {\n      this.currentReport = row;\n      this.detailDialogVisible = true;\n    },\n    handleApprove(row) {\n      this.currentReport = row;\n      this.handleForm.reportId = row.id;\n      this.handleForm.reason = \"\";\n      this.handleForm.action = \"approve\";\n      this.dialogTitle = \"通过举报\";\n      this.handleDialogVisible = true;\n    },\n    handleReject(row) {\n      this.currentReport = row;\n      this.handleForm.reportId = row.id;\n      this.handleForm.reason = \"\";\n      this.handleForm.action = \"reject\";\n      this.dialogTitle = \"拒绝举报\";\n      this.handleDialogVisible = true;\n    },\n    submitHandle() {\n      if (!this.handleForm.reason) {\n        this.$message.warning(\"请输入处理原因\");\n        return;\n      }\n      \n      const data = {\n        reportId: this.handleForm.reportId,\n        handleReason: this.handleForm.reason\n      };\n      \n      this.loading = true;\n      \n      if (this.handleForm.action === \"approve\") {\n        this.$api.adminHandleReport(data)\n          .then(this.handleResponse)\n          .catch(this.handleError)\n          .finally(() => {\n            this.loading = false;\n          });\n      } else {\n        this.$api.adminRejectReport(data)\n          .then(this.handleResponse)\n          .catch(this.handleError)\n          .finally(() => {\n            this.loading = false;\n          });\n      }\n    },\n    handleResponse(res) {\n      if (res.status_code === 1) {\n        this.$message.success(res.msg || \"处理成功\");\n        this.handleDialogVisible = false;\n        this.detailDialogVisible = false;\n        this.fetchReportList();\n      } else {\n        this.$message.error(res.msg || \"处理失败\");\n      }\n    },\n    handleError(err) {\n      console.error(err);\n      this.$message.error(\"处理失败\");\n    },\n    viewItem(itemId) {\n      if (itemId) {\n        window.open(`/details?id=${itemId}`, '_blank');\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.report-list-container {\n  padding: 20px;\n}\n\n.search-bar {\n  display: flex;\n  margin-bottom: 20px;\n}\n\n.search-input {\n  width: 300px;\n  margin-right: 15px;\n}\n\n.pagination {\n  margin-top: 20px;\n  text-align: right;\n}\n\n.detail-item {\n  margin-bottom: 15px;\n  line-height: 24px;\n}\n\n.label {\n  font-weight: bold;\n  margin-right: 10px;\n  display: inline-block;\n  width: 100px;\n  text-align: right;\n}\n</style> "]}]}